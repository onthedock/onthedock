<!DOCTYPE html>
<html ⚡>
  <head>
    <meta charset="utf-8">
<meta name="pinterest" content="nopin">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name="theme-color" content="#263238">

<meta name="generator" content="Hugo 0.68.3" />

<link rel="apple-touch-icon" href="https://onthedock.github.io/images/logo.png">


<link rel="canonical" href="https://onthedock.github.io/post/210321-k3d-k3s-en-docker/">


    
    <link href="https://fonts.googleapis.com/css?family=Lobster|Lato:400,700" rel="stylesheet">
    
    <title>k3d: k3s en Docker (o la manera más rápida de montar clústers de Kubernetes para desarrollo) - On The Dock</title>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    
    <script async custom-element="amp-twitter" src="https://cdn.ampproject.org/v0/amp-twitter-0.1.js"></script>
<script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
<script async custom-element="amp-ad" src="https://cdn.ampproject.org/v0/amp-ad-0.1.js"></script>

    
<meta name="description" content="&lt;p&gt;&lt;a href=&#34;https://kind.sigs.k8s.io/&#34;&gt;kind&lt;/a&gt; es una herramienta para ejecutar clústers de Kubernetes en los que cada &amp;ldquo;nodo&amp;rdquo; del clúster se ejecuta en un contenedor. &lt;a href=&#34;https://k3d.io/&#34;&gt;k3d&lt;/a&gt; toma esta misma idea pero en vez de un clúster de Kubernetes &lt;em&gt;vanilla&lt;/em&gt;, despliega un clúster de &lt;strong&gt;&lt;a href=&#34;https://k3s.io/&#34;&gt;k3s&lt;/a&gt;&lt;/strong&gt; usando contenedores como &amp;ldquo;nodos&amp;rdquo;.&lt;/p&gt;">

<meta property="og:title" content="k3d: k3s en Docker (o la manera más rápida de montar clústers de Kubernetes para desarrollo) - On The Dock">
<meta property="og:type" content="article">
<meta property="og:url" content="https://onthedock.github.io/post/210321-k3d-k3s-en-docker/">
<meta property="og:image" content="https://onthedock.github.io/images/k3s.png">
<meta property="og:site_name" content="On The Dock">
<meta property="og:description" content="&lt;p&gt;&lt;a href=&#34;https://kind.sigs.k8s.io/&#34;&gt;kind&lt;/a&gt; es una herramienta para ejecutar clústers de Kubernetes en los que cada &amp;ldquo;nodo&amp;rdquo; del clúster se ejecuta en un contenedor. &lt;a href=&#34;https://k3d.io/&#34;&gt;k3d&lt;/a&gt; toma esta misma idea pero en vez de un clúster de Kubernetes &lt;em&gt;vanilla&lt;/em&gt;, despliega un clúster de &lt;strong&gt;&lt;a href=&#34;https://k3s.io/&#34;&gt;k3s&lt;/a&gt;&lt;/strong&gt; usando contenedores como &amp;ldquo;nodos&amp;rdquo;.&lt;/p&gt;">
<meta property="og:locale" content="ja_JP">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="On The Dock">
<meta name="twitter:url" content="https://onthedock.github.io/post/210321-k3d-k3s-en-docker/">
<meta name="twitter:title" content="k3d: k3s en Docker (o la manera más rápida de montar clústers de Kubernetes para desarrollo) - On The Dock">
<meta name="twitter:description" content="&lt;p&gt;&lt;a href=&#34;https://kind.sigs.k8s.io/&#34;&gt;kind&lt;/a&gt; es una herramienta para ejecutar clústers de Kubernetes en los que cada &amp;ldquo;nodo&amp;rdquo; del clúster se ejecuta en un contenedor. &lt;a href=&#34;https://k3d.io/&#34;&gt;k3d&lt;/a&gt; toma esta misma idea pero en vez de un clúster de Kubernetes &lt;em&gt;vanilla&lt;/em&gt;, despliega un clúster de &lt;strong&gt;&lt;a href=&#34;https://k3s.io/&#34;&gt;k3s&lt;/a&gt;&lt;/strong&gt; usando contenedores como &amp;ldquo;nodos&amp;rdquo;.&lt;/p&gt;">
<meta name="twitter:image" content="https://onthedock.github.io/images/k3s.png">


<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "NewsArticle",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id":"https:\/\/onthedock.github.io\/"
    },
    "headline": "k3d: k3s en Docker (o la manera más rápida de montar clústers de Kubernetes para desarrollo) - On The Dock",
    "image": {
      "@type": "ImageObject",
      "url": "https:\/\/onthedock.github.io\/images\/k3s.png",
      "height": 800,
      "width": 800
    },
    "datePublished": "2021-03-21T18:21:07JST",
    "dateModified": "2021-03-21T18:21:07JST",
    "author": {
      "@type": "Person",
      "name": "On The Dock"
    },
    "publisher": {
      "@type": "Organization",
      "name": "On The Dock",
      "logo": {
        "@type": "ImageObject",
        "url": "https:\/\/onthedock.github.io\/images/logo.png",
        "width": 600,
        "height": 60
      }
    },
    "description": "\x3cp\x3e\x3ca href=\x22https:\/\/kind.sigs.k8s.io\/\x22\x3ekind\x3c\/a\x3e es una herramienta para ejecutar clústers de Kubernetes en los que cada \x26ldquo;nodo\x26rdquo; del clúster se ejecuta en un contenedor. \x3ca href=\x22https:\/\/k3d.io\/\x22\x3ek3d\x3c\/a\x3e toma esta misma idea pero en vez de un clúster de Kubernetes \x3cem\x3evanilla\x3c\/em\x3e, despliega un clúster de \x3cstrong\x3e\x3ca href=\x22https:\/\/k3s.io\/\x22\x3ek3s\x3c\/a\x3e\x3c\/strong\x3e usando contenedores como \x26ldquo;nodos\x26rdquo;.\x3c\/p\x3e"
  }
</script>


    <style amp-custom>
      html { font-size: 18px;}@media (max-width: 768px) { html { font-size: 15px; }}body { font-family: Lato,'Hiragino Kaku Gothic Pro',メイリオ,Meiryo,sans-serif; font-size: inherit; margin: 0; color: #263238;}html, body { margin: 0;}a { text-decoration: none; color: #e91e63;}p { margin: 0;}ul,ol { margin: 0; padding: 0;}h1, h2, h3, h4, h5, h6 { margin: 0; font-weight: 700;}h1 { font-size: 1.8rem; line-height: 2rem; margin: 1.5rem 0; }h2 { font-size: 1.4rem; line-height: 2rem; margin: 1.5rem 0; }h3 { font-size: 1.2rem; line-height: 1.5rem; margin: 1.5rem 0; }h4, h5, h6 { font-size: 1rem; line-height: 1.5rem; margin: 1.5rem 0; }.clearfix::after { content: ''; display: block; clear: both;}main{ display: block;}.searchbar{ display: block; border: none; margin: 1em auto; max-width: 780px; text-align: center;}/* Layouts */.l-header { padding: .5rem 0; margin-bottom: 2rem; border-bottom: 1px dashed #cfd8dc; text-align: center;}.l-footer { font-size: .8rem; padding: 1rem 0; border-top: 1px dashed #cfd8dc;}.l-footer .copyright-notice,.l-footer .attribution { text-align: center;}.l-container { max-width: 42rem; margin: 0 auto; padding: 0 1rem;}/* Parts:logo */.p-logo { font-family: Lobster, cursive;}.p-logo a { color: #000; font-size: 1.6rem; line-height: 2rem;}/* Parts:section */section { border-top: 2px solid #eceff1; padding: 1.5rem 0;}section>header { text-transform: uppercase; font-weight: 700; margin-bottom: 2rem; text-align: center;}section>header span { display: inline-block; background-color: #000; color: #fff; letter-spacing: 3px; font-size: .7rem; padding: .5rem .75rem;}/* Parts:facts */.p-facts { list-style: none; font-size: .8rem; margin-bottom: 1rem;}.p-facts:last-child { margin-bottom: 0;}.p-facts li { display: inline-block; margin-right: .5rem; text-transform: uppercase;}.p-facts li header { margin-bottom: .25rem; font-weight: 700;}.p-facts li header a { color: #000; text-decoration: underline;}.p-facts li li { display: inline-block; margin-right: .5rem;}.p-facts li li::after { content: ',';}.p-facts li li:last-child::after { content: '';}/* Parts:crumb */.p-crumb { list-style: none; margin-bottom: 1rem; font-size: .8rem; text-transform: uppercase; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.p-crumb:last-child { margin-bottom: 0;}.p-crumb li { display: inline;}.p-crumb li::after { content: '›'; margin: 0 .5rem;}.p-crumb li:last-child::after { content: '';}/* Parts:page-title */.p-page-title { margin-bottom: 2rem;}.p-page-title .title { margin-bottom: .5rem;}/* Parts:share */.p-share { margin-bottom: 1.5rem; text-align: center;}.p-share a { display: inline-block; text-align: center; padding: .5rem .5rem; margin-right: .25rem; font-size: .6rem; background-color: #eceff1; font-weight: 700;}.p-share a.ht { color: #00a4de; }.p-share a.fb { color: #3b5998; }.p-share a.tw { color: #1da1f2; }.p-share a.ln { color: #00c300; }.p-share a.ht::before { content: 'Hatena'; }.p-share a.fb::before { content: 'Facebook'; }.p-share a.tw::before { content: 'Twitter'; }.p-share a.ln::before { content: 'LINE'; }/* Parts:terms */.p-terms { padding-left: 2rem;}/* Parts:paginator */.p-paginator { text-align: center; margin-bottom: 3rem; padding-top: 2rem;}.p-paginator a { display: inline-block; border: 2px solid #eceff1; color: #263238; line-height: 2rem; padding: 0 1rem;}/* Parts:article */.p-articles { list-style: none;}.p-articles>li { margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px dashed #cfd8dc;}.p-articles>li:last-child { border-bottom: none; padding-bottom: 0;}.p-articles.thin>li { margin-bottom: 1rem; padding-bottom: 1rem;}article .article-header { display: table-cell; height: 6rem; vertical-align: middle;}article .title { margin: 0; margin-bottom: .5rem; font-size: 1.4rem; line-height: 2rem;}article .title a { color: #000;}article .header-wrapper { margin-bottom: 1.5rem;}article .thumbnail { display: block; background-position: center; background-size: cover; background-image: url(https://onthedock.github.io/images/default.jpg); width: 6rem; height: 6rem; border-radius: 50%; box-shadow: 0 0 3px 0 #333 inset; float: left; margin-right: 1rem;}article .summary { margin-bottom: 1.5rem;}article .readmore { text-align: center;}article .readmore a { font-size: .8rem; color: #000; text-decoration: underline;}article.li.sm .header-wrapper { margin-bottom: 0;}.article-body h2 { padding: 1rem 0; color: #55bbbb; border-bottom: 2px solid #eceff1;}.article-body h2:first-child { margin-top: 0; }.article-body h3 { color: #8997e4; font-style: italic;}.article-body h4 { border-left: solid .25rem #cddc39; padding: 0 .5rem;}.article-body p { margin: 1.5rem 0; line-height: 1.5rem;}.article-body a { text-decoration: underline;}.article-body ul,.article-body ol { padding-left: 1.5rem;}.article-body li { line-height: 2rem;}.article-body code { display: inline-block; font-family: Menlo, consolas, monospace; background-color: #eceff1; font-size: .8rem; padding: 0 .5rem; line-height: 1.5rem;}.article-body pre { margin: 1.5rem 0; padding: 1.5rem; font-size: .8rem; background-color: #eeeeef; color: #444; overflow: auto;}.article-body pre code { background-color: transparent;}.article-body blockquote { /* margin: 1.2rem 0; padding: .5rem 0; */ /*font-size: .8rem;*/ border-top: 1px solid #eceff1; border-bottom: 1px solid #eceff1; color: #607d8b;}.article-body blockquote p { margin: .5rem 0; line-height: 1.5rem;}.article-body strong { /*box-shadow: 0 -.5rem 0 0 #f06292 inset;*/ font-style: bold; font-weight: 700; /*color: #ff5722; */}.article-body em { /*font-style: normal;*/ /*font-weight: 700; color: #00c300;*/ /*color: #00c300;*/ font-style: oblique;}.article-body figure { margin: 1.5rem -2rem; }.article-body figure.left,.article-body figure.right { width: 15rem; height: 12rem; margin-top: 0; margin-left: 0; margin-right: 0;}.article-body figure.left { float: left; margin-right: 1rem; margin-left: -2rem; }.article-body figure.right { float: right; margin-left: 1rem; margin-right: -2rem; }@media (max-width: 768px) { .article-body figure { margin: 1.5rem -1rem; } .article-body figure.left, .article-body figure.right { float: none; margin: 0 -1rem; width: auto; height: auto; }}.article-body figcaption { padding: .5rem 0; font-size: .8rem; text-align: center;}.article-body figcaption a { color: #263238;}

       .article-ac2fd5351d9eef9e4357a5d80b0a43e8 .thumbnail { background-image: url(https://onthedock.github.io/images/k3s.png);  }  .article-fca7a454728b2f5a01888983d70e6476 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-32fa31070432a9a2d86d78f72a8244ad .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-e447bc414104c15405ae169ace8c2b29 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-38e84f875db85488c523f3257aba8fdd .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-f87949b99018c181546093186e412e32 .thumbnail { background-image: url(https://onthedock.github.io/images/git.png);  }  .article-fee94cef98f533fac0c5c909c2cbb884 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-56505d63d80c0cf676712e0761ce6b57 .thumbnail { background-image: url(https://onthedock.github.io/images/gitea.jpg);  }  .article-1be861ee6a7c05ba2a5776a68120327c .thumbnail { background-image: url(https://onthedock.github.io/images/traefik.png);  }  .article-6196d298c4378d228f2ab7aeacc3b954 .thumbnail { background-image: url(https://onthedock.github.io/images/links.png);  }  .article-989c3a6a94e729ffbdf9bda5f321b198 .thumbnail { background-image: url(https://onthedock.github.io/images/roadmap.png);  }  .article-b5774c1af73ca2d2b4752dba3cca3af5 .thumbnail { background-image: url(https://onthedock.github.io/images/bug.png);  }  .article-5e7a622986ce86264ec760d50d1b24dc .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-5ebb631840a278963e57bd511343a7de .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-b81d424b8eb3bb8c288fe36d23387788 .thumbnail { background-image: url(https://onthedock.github.io/images/gitea.jpg);  }  .article-0626a0be459395ce9ead913f3f08adc4 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-fcee06d4be0563afd210fdcfb47dcff0 .thumbnail { background-image: url(https://onthedock.github.io/images/virtualbox.png);  }  .article-1db77bc78e9304df7ba062b03813a3be .thumbnail { background-image: url(https://onthedock.github.io/images/virtualbox.png);  }  .article-36c4d422ca047b8a471571c76b65d6c6 .thumbnail { background-image: url(https://onthedock.github.io/images/git.png);  }  .article-4c8c13dd5627da332e5774b27cf40099 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-6e92220fbd4bf73e9add44ea35db7875 .thumbnail { background-image: url(https://onthedock.github.io/images/cloud-init.png);  }  .article-65945fdc2f7a451d2eba88e27bcae615 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-d4ae75e268955792710fe6fdbf38a8cd .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-f875614400506b86e2eed3af9535c6f0 .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-70ddbb73f4be0ef264658d45b44a1501 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-af7ce20f88530a679b64bc11f369dd66 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-749180de0a0f927ac4118d5f742aec7a .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-eabbba2a574b52017ab09aadb1e27892 .thumbnail { background-image: url(https://onthedock.github.io/images/git.png);  }  .article-4df08a53150d4f7d2766c8debd1831a3 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-ae823e9b9f3db0ab3a477ed5e16bcb32 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-9e165e5c05a4125a00ec1ec5048a7d4c .thumbnail { background-image: url(https://onthedock.github.io/images/git.png);  }  .article-0b46f42d26003d0a8a0c0a8792e872c3 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-bf486333bdc41366eb67ebcd83df7dfd .thumbnail { background-image: url(https://onthedock.github.io/images/okd.png);  }  .article-5b04a4598c80921d43637c7023ad4877 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-6548eb3cdf7ceb97a246efd3d61b22ae .thumbnail { background-image: url(https://onthedock.github.io/images/code.jpg);  }  .article-67ffd386f3fb60aa875a1b304dcbd33c .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-fdbe83149bbb772c83e8270b925cba5f .thumbnail { background-image: url(https://onthedock.github.io/images/code.jpg);  }  .article-fa396b4de84b2dfd9b95c5edfc10cc30 .thumbnail { background-image: url(https://onthedock.github.io/images/python.png);  }  .article-296c831bcc1b030d00b8ee27e96a5226 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-b2b753da998b1936d8c475787c1de07f .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-b95004b4126fa41395385c5e37f31081 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-a8fd68175b85c6ab1e57dd164e56c25e .thumbnail { background-image: url(https://onthedock.github.io/images/MabelAmber-mini.png);  }  .article-cd0ad924309bc0e2310a28f4574f3ee6 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-c4149a0be2e1a3d215d0b9dbb1340cad .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-c04747c53dc824266e9428efb65f072d .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-c6d431118f1f3fa0e4ec3e6e454bb634 .thumbnail { background-image: url(https://onthedock.github.io/images/roadmap.png);  }  .article-1ce4351c9635f2cadcc6057dd96238d9 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-8cb097c83a6ec6e1fe01c4278c8a35c6 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-22355649e0a434b67e571674216e1e54 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-23858711b322c88a48f2b2d742a36f3d .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-d92b1a0387e28368be9738f69f1aa7ce .thumbnail { background-image: url(https://onthedock.github.io/images/alpine.png);  }  .article-98124356b113c2a6917683aca3c29a99 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-a093ac0f1b7268afeade39452595d2f1 .thumbnail { background-image: url(https://onthedock.github.io/images/bug.png);  }  .article-38834ecfa3e2f37d5a70e6884d71074a .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-932932e45567c9f06aca44ce87e2a385 .thumbnail { background-image: url(https://onthedock.github.io/images/bug.png);  }  .article-c1ca90597f186bd1ad8bb1c94f4a447a .thumbnail { background-image: url(https://onthedock.github.io/images/alpine.png);  }  .article-765192a6c291e47974a12dcf8924d8db .thumbnail { background-image: url(https://onthedock.github.io/images/ansible.png);  }  .article-b764fa70c94a1d2fd4fd14237d21967d .thumbnail { background-image: url(https://onthedock.github.io/images/python.png);  }  .article-f68c36fc2fb55e32944f45e490e5e5e9 .thumbnail { background-image: url(https://onthedock.github.io/images/ansible.png);  }  .article-bd81d8ba70bc61639103fb97b7490aed .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-1c63237c8383a2e30ee2e3fcc7150643 .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-c0152a70142649803b63b10edd4921d3 .thumbnail { background-image: url(https://onthedock.github.io/images/asciidoctor.png);  }  .article-396652c83bff211b566a6a3fd5bf1913 .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-bde56cbd0283e6a7909a444b8e08e5c5 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-0c530d26aef03bb376ea14c3014c0325 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-0d445519a7825dfd55db94b8b9817031 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-a57735573e4d2b1c48a69a09a73878b7 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-ccf02aadbf150df00f9a2962c5cc2c32 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-b4fa6645c244835f679427bd29ec86fb .thumbnail { background-image: url(https://onthedock.github.io/images/190101/amazonlinux.png);  }  .article-1f90092555e2ba74f132561ef66df1d5 .thumbnail { background-image: url(https://onthedock.github.io/images/ansible.png);  }  .article-702ecd15d93c0a640329570a1515ec22 .thumbnail { background-image: url(https://onthedock.github.io/images/181124/roadmap.png);  }  .article-fe261e0b7d326a141c1ff662c1caf421 .thumbnail { background-image: url(https://onthedock.github.io/images/cloud-init.png);  }  .article-2fc7b42f0ad38b1d0c3bda16184154ed .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-9a5a658f072f34635bd665eae7d0d498 .thumbnail { background-image: url(https://onthedock.github.io/images/docker-compose.jpg);  }  .article-f8770956a383aeb68930a558bae85310 .thumbnail { background-image: url(https://onthedock.github.io/images/automation.png);  }  .article-d27d7b7a4057230acbe88420832d3a67 .thumbnail { background-image: url(https://onthedock.github.io/images/gitea.jpg);  }  .article-365473b8c27877be27245e38a5feb95c .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-8da35239d2403351cd1910b3939787f6 .thumbnail { background-image: url(https://onthedock.github.io/images/jenkins.png);  }  .article-4f389af4c69dce1f727b95af66218cc0 .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-b63b63041915fd06eb96d2d6b298ac9b .thumbnail { background-image: url(https://onthedock.github.io/images/sonarqube.png);  }  .article-db94723578a25efdcd1489b628ae77c9 .thumbnail { background-image: url(https://onthedock.github.io/images/sonarqube.png);  }  .article-92e6838a86f3c412b36d6abbbb0f3f77 .thumbnail { background-image: url(https://onthedock.github.io/images/jenkins.png);  }  .article-8fd0d0535b25566772d8bfcab456999e .thumbnail { background-image: url(https://onthedock.github.io/images/gogs.png);  }  .article-9d852d24f77755909ea56d2ce72cb408 .thumbnail { background-image: url(https://onthedock.github.io/images/jenkins.png);  }  .article-015f92caa0da0be71b6008713be0e15f .thumbnail { background-image: url(https://onthedock.github.io/images/gogs.png);  }  .article-b40404c5768e20c9cf4a0ef9b40d5d8c .thumbnail { background-image: url(https://onthedock.github.io/images/jenkins.png);  }  .article-56679bf127fa712be78799b59e8ebcbe .thumbnail { background-image: url(https://onthedock.github.io/images/jenkins.png);  }  .article-c926846ccb5ddda2e607d41a7eed1e7e .thumbnail { background-image: url(https://onthedock.github.io/images/jenkins.png);  }  .article-439d0c4b480f76cd3e4e59c497020808 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-ca9a82a3e9074b202ea71b79b8f06d72 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-5dd2fbecd3c1861b16d6ccbae8458692 .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-d27ecb2023ff85d0423abc98d4d8ded4 .thumbnail { background-image: url(https://onthedock.github.io/images/portainer.png);  }  .article-82fdfab1e200b6fc1a28801ee717993c .thumbnail { background-image: url(https://onthedock.github.io/images/jenkins.png);  }  .article-ff3cf8144aa52ea6d7195126da8ce676 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-88a2b37925efc71e7f9ec017570e19f0 .thumbnail { background-image: url(https://onthedock.github.io/images/vagrant.png);  }  .article-f22b7fd29e14db2fbd6cd579c2a0d5c9 .thumbnail { background-image: url(https://onthedock.github.io/images/vagrant.png);  }  .article-fc9c9a2b1dcd0c5683f7adbafda8f7c8 .thumbnail { background-image: url(https://onthedock.github.io/images/vagrant.png);  }  .article-a45fe2c1cdbadc45cbf34a63ab37ebcc .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-9e27e7f162c2feae804cbc006c1c9349 .thumbnail { background-image: url(https://onthedock.github.io/images/MabelAmber-mini.png);  }  .article-2a7b6b0759e163accb88c9261e4c0bbf .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-340e5d68f76888b0b8debb38ef25d46b .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-2fc73bdfb18aaf2eb89944fb4f7d53de .thumbnail { background-image: url(https://onthedock.github.io/images/gogs.png);  }  .article-70a1a0028c7c78526f004c0e3218a2b3 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-f81b2bb759a18deaa3b5575087686fe7 .thumbnail { background-image: url(https://onthedock.github.io/images/gogs.png);  }  .article-156dcec052e59d7d9f0de2250fda46f4 .thumbnail { background-image: url(https://onthedock.github.io/images/dokuwiki-on-docker.png);  }  .article-f831baebaad56b8e3d70750749393da3 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-df14f92fc6edab1c8632e66ef7c7e5a6 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-516ab75e14eb7886aaab03ff75dbfc6b .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-d1ead2ec3d26cb7f91ef8234915eb13f .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-0b9c6f0820f2306f6cc2bfd170dccb8e .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-1cbc9cfd0ad3798b23d19eac020b3153 .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-a32274b07ce43fef61c7f19e4b68f650 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-9b0b3a180af20b5c091134d23cb6d383 .thumbnail { background-image: url(https://onthedock.github.io/images/minio.jpg);  }  .article-b20735633157cb1e57eb0c1d05406149 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-d1e335a06f765bffda53d2e123044b27 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-c36c64b9d6ce0d2c95381976831c3160 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-ee7d8acecc9de179b9d1cecb3d253215 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-2480be47fe45cfc13b07c86c32ed8cda .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-99a6578fdc273f40a61d182bcb5917c4 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-3ffff09a2dd1f953bbb8624d88756829 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-0a9cef5c4637bd946188e37439fef69c .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-42a206d287914317761f7749b964ddb2 .thumbnail { background-image: url(https://onthedock.github.io/images/alpine.png);  }  .article-85dee6c250520e561ebc93740f1d514f .thumbnail { background-image: url(https://onthedock.github.io/images/alpine.png);  }  .article-a65000ba68f97000bb927be3f88f75bd .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-2de6ff3b0144ea18b2ef056107448a33 .thumbnail { background-image: url(https://onthedock.github.io/images/yaml.png);  }  .article-a8aea2191f0d8d238ab6217feba51ac3 .thumbnail { background-image: url(https://onthedock.github.io/images/vagrant.png);  }  .article-67cd76b76e108b6604b344e92a3c329a .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-d341a5f8cd54b9da7a3a6d1168365c25 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-59e1fe22eaedce05afe517780f87cc98 .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-87ee3835fe3b255e8566c3bfed2bd38b .thumbnail { background-image: url(https://onthedock.github.io/images/portainer.png);  }  .article-086bb6242700303c8a958c5e74df0ca9 .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-4c6b9124141ca1a8135b9177248b7e15 .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-911698c11286b3ef9eb1a11440c09845 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-6a0861472d6f0696079c81e3710d5fe8 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-40b8655184d8e4a2ca3650aece49e845 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-857a5f627557e7d92f1386f7c6e04dee .thumbnail { background-image: url(https://onthedock.github.io/images/raspberry_pi.png);  }  .article-4db85da082f771e8fb9029adad4173ec .thumbnail { background-image: url(https://onthedock.github.io/images/raspberry_pi.png);  }  .article-b69159ccecf58bff548bbd08481b6e15 .thumbnail { background-image: url(https://onthedock.github.io/images/raspberry_pi.png);  }  .article-da222607e970c37b0b59d8011a2e3398 .thumbnail { background-image: url(https://onthedock.github.io/images/portainer.png);  }  .article-7b36708a64c36890ceb1bf481f3de1fa .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-d68e08dcca5eafff4ae0d8d06280bf02 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-8ff87e4d24c357bbee842dd088ef4cde .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-d0ca4b0abe6c0c6d22baa800e3fc9935 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-63c13529eb1936073e0adc09d7e35b59 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-2e821bde62a219fe0b94f62e989269e7 .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-df564c824db9099fd85c925ad9635cda .thumbnail { background-image: url(https://onthedock.github.io/images/raspberry_pi.png);  }  .article-203d2d443889d9d70ca2ad9abcca49aa .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-526bade0815ac377e81216604b97c5f7 .thumbnail { background-image: url(https://onthedock.github.io/images/github.png);  }  .article-3d9c586728a0009cb0621b0368120462 .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-160ee3ec04bb73e590f125b42640b34b .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-c862ac2fb3511b386b4247a80aa6b90b .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-8a50a2d4216b1a3b2b46c646bd24c5e9 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-f027d2889032f918da8e3cc9c03169e0 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-6db4ecfe853552466ce5a71b1221a2a0 .thumbnail { background-image: url(https://onthedock.github.io/images/hypriot.png);  } 
    </style>
  </head>

  <body>
    
    
    

    <header class="l-header">
      <div class="l-container">
        <div class="h-logo p-logo">
          <a href="https://onthedock.github.io/" class="h-logo">On The Dock</a>
          <p class="h-logo">Un blog sobre el Cloud, Kubernetes, DevOps, Docker y Raspberry Pi por Xavier Aznar</p>
        </div>
      </div>
    </header>

    <main>
      
<div class="l-container">
  <article class="single article-ac2fd5351d9eef9e4357a5d80b0a43e8">
  <div class="header-wrapper">
    <a href="https://onthedock.github.io/post/210321-k3d-k3s-en-docker/" class="thumbnail" title="k3d: k3s en Docker (o la manera más rápida de montar clústers de Kubernetes para desarrollo)"></a>
    <header class="article-header">
      <div class="clearfix">
        <h1 class="title">k3d: k3s en Docker (o la manera más rápida de montar clústers de Kubernetes para desarrollo)</h1>
        <ul class="p-facts">
          <li><time datetime="2021-03-21T18:21:07JST">21 Mar 2021</time></li>
          <li><a href="https://onthedock.github.io/post/">post</a></li>
          
          <li>Xavier Aznar</li>
        </ul>
      </div>
    </header>
  </div>

  <div class="article-body"><p><a href="https://kind.sigs.k8s.io/">kind</a> es una herramienta para ejecutar clústers de Kubernetes en los que cada &ldquo;nodo&rdquo; del clúster se ejecuta en un contenedor. <a href="https://k3d.io/">k3d</a> toma esta misma idea pero en vez de un clúster de Kubernetes <em>vanilla</em>, despliega un clúster de <strong><a href="https://k3s.io/">k3s</a></strong> usando contenedores como &ldquo;nodos&rdquo;.</p>
<p><strong>k3s</strong> es una distribución certificada de Kubernetes, pero mucho más <em>ligera</em>. <em>k3s</em> usa SQLite3 como base de datos interna, en vez de <em>etcd</em>, por ejemplo y ejecuta los diferentes controladores como un sólo fichero ejecutable. Todas estas modificaciones permiten <strong>mantener toda la funcionalidad de Kubernetes</strong>, pero con un binario de menos de 40MB (según indica la documentación oficial <a href="https://k3s.io/">k3s.io</a>).</p>
<p>Siguiendo la idea de <strong>kind</strong>, se puede desplegar un clúster de <em>k3s</em> usando Docker como plataforma: cada nodo del clúster se despliega como un contenedor.</p>
<h2 id="instalación">Instalación</h2>
<p>La instalación de <em>k3d</em> requiere disponer de Docker instalado; para desplegar un clúster, se proporciona la herramienta <code>k3d</code>, con la que podemos especificar el número de nodos servidores y agentes del clúster, así como muchas otras opciones.</p>
<p>La documentación oficial indica cómo instalar <strong>k3d</strong> usando varios métodos, como por ejemplo usando un <em>script</em> de instalación:</p>
<blockquote>
<p>Antes de ejecutar cualquier cosa desde internet, revisa si el <em>script</em> hace únicamente lo que se supone que debe hacer.</p>
</blockquote>
<p>El cuerpo del <em>script</em> revisa el entorno local, descarga <em>k3d</em> y lo instala:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">...
initArch
initOS
verifySupported
checkTagProvided <span style="color:#f92672">||</span> checkLatestVersion
<span style="color:#66d9ef">if</span> ! checkK3dInstalledVersion; <span style="color:#66d9ef">then</span>
  downloadFile
  installFile
<span style="color:#66d9ef">fi</span>
testVersion
cleanup
</code></pre></div><p>El detalle de la instalación:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">...
<span style="color:#75715e"># installFile verifies the SHA256 for the file, then unpacks and</span>
<span style="color:#75715e"># installs it.</span>
installFile<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
  echo <span style="color:#e6db74">&#34;Preparing to install </span>$APP_NAME<span style="color:#e6db74"> into </span><span style="color:#e6db74">${</span>K3D_INSTALL_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
  runAsRoot chmod +x <span style="color:#e6db74">&#34;</span>$K3D_TMP_FILE<span style="color:#e6db74">&#34;</span>
  runAsRoot cp <span style="color:#e6db74">&#34;</span>$K3D_TMP_FILE<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span>$K3D_INSTALL_DIR<span style="color:#e6db74">/</span>$APP_NAME<span style="color:#e6db74">&#34;</span>
  echo <span style="color:#e6db74">&#34;</span>$APP_NAME<span style="color:#e6db74"> installed into </span>$K3D_INSTALL_DIR<span style="color:#e6db74">/</span>$APP_NAME<span style="color:#e6db74">&#34;</span>
<span style="color:#f92672">}</span>
...
</code></pre></div><p>Una vez revisado el <em>script</em>, lanzamos la instalación:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl -s https://raw.githubusercontent.com/rancher/k3d/main/install.sh | bash
</code></pre></div><p>Al finalizar, valida que <em>k3d</em> se ha instalado correctamente:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ k3d version
k3d version v4.2.0
k3s version v1.20.2-k3s1 <span style="color:#f92672">(</span>default<span style="color:#f92672">)</span>
</code></pre></div><h2 id="crear-un-clúster-manualmente">Crear un clúster (manualmente)</h2>
<p>Como ejemplo, vamos a crear un clúster llamado <code>dev-cluster</code> con un nodo servidor (<code>-s 1</code>) y un nodo agente (<code>-a 1</code>):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ k3d cluster create dev-cluster -s <span style="color:#ae81ff">1</span> -a <span style="color:#ae81ff">1</span>
INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Prep: Network                                
INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Created network <span style="color:#e6db74">&#39;k3d-dev-cluster&#39;</span>            
INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Created volume <span style="color:#e6db74">&#39;k3d-dev-cluster-images&#39;</span>      
INFO<span style="color:#f92672">[</span>0001<span style="color:#f92672">]</span> Creating node <span style="color:#e6db74">&#39;k3d-dev-cluster-server-0&#39;</span>     
INFO<span style="color:#f92672">[</span>0001<span style="color:#f92672">]</span> Creating node <span style="color:#e6db74">&#39;k3d-dev-cluster-agent-0&#39;</span>      
INFO<span style="color:#f92672">[</span>0001<span style="color:#f92672">]</span> Creating LoadBalancer <span style="color:#e6db74">&#39;k3d-dev-cluster-serverlb&#39;</span> 
INFO<span style="color:#f92672">[</span>0001<span style="color:#f92672">]</span> Starting cluster <span style="color:#e6db74">&#39;dev-cluster&#39;</span>               
INFO<span style="color:#f92672">[</span>0001<span style="color:#f92672">]</span> Starting servers...                          
INFO<span style="color:#f92672">[</span>0001<span style="color:#f92672">]</span> Starting Node <span style="color:#e6db74">&#39;k3d-dev-cluster-server-0&#39;</span>     
INFO<span style="color:#f92672">[</span>0010<span style="color:#f92672">]</span> Starting agents...                           
INFO<span style="color:#f92672">[</span>0010<span style="color:#f92672">]</span> Starting Node <span style="color:#e6db74">&#39;k3d-dev-cluster-agent-0&#39;</span>      
INFO<span style="color:#f92672">[</span>0023<span style="color:#f92672">]</span> Starting helpers...                          
INFO<span style="color:#f92672">[</span>0023<span style="color:#f92672">]</span> Starting Node <span style="color:#e6db74">&#39;k3d-dev-cluster-serverlb&#39;</span>     
INFO<span style="color:#f92672">[</span>0024<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>Optional<span style="color:#f92672">)</span> Trying to get IP of the docker host and inject it into the cluster as <span style="color:#e6db74">&#39;host.k3d.internal&#39;</span> <span style="color:#66d9ef">for</span> easy access 
INFO<span style="color:#f92672">[</span>0030<span style="color:#f92672">]</span> Successfully added host record to /etc/hosts in 3/3 nodes and to the CoreDNS ConfigMap 
INFO<span style="color:#f92672">[</span>0030<span style="color:#f92672">]</span> Cluster <span style="color:#e6db74">&#39;dev-cluster&#39;</span> created successfully!  
INFO<span style="color:#f92672">[</span>0030<span style="color:#f92672">]</span> --kubeconfig-update-default<span style="color:#f92672">=</span>false --&gt; sets --kubeconfig-switch-context<span style="color:#f92672">=</span>false 
INFO<span style="color:#f92672">[</span>0030<span style="color:#f92672">]</span> You can now use it like this:                
kubectl config use-context k3d-dev-cluster
kubectl cluster-info
</code></pre></div><p><em>k3d</em> se ejecuta como contenedores, por lo que podemos ver las imágenes usadas para construir los &ldquo;nodos&rdquo; mediante:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ docker images
REPOSITORY          TAG            IMAGE ID       CREATED        SIZE
rancher/k3d-proxy   v4.2.0         70ec1f255a8a   <span style="color:#ae81ff">5</span> weeks ago    44.4MB
rancher/k3s         v1.20.2-k3s1   1b02adf07426   <span style="color:#ae81ff">2</span> months ago   154MB
</code></pre></div><p>Del mismo modo, revisamos los &ldquo;nodos&rdquo; del clúster:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ docker ps
CONTAINER ID   IMAGE                      COMMAND                  CREATED       STATUS     PORTS                             NAMES
311f7f0cf5dc   rancher/k3d-proxy:v4.2.0   <span style="color:#e6db74">&#34;/bin/sh -c nginx-pr…&#34;</span>   <span style="color:#ae81ff">20</span> hours ago  Up <span style="color:#ae81ff">2</span> hours 80/tcp, 0.0.0.0:32945-&gt;6443/tcp   k3d-dev-cluster-serverlb
81521d5ea62f   rancher/k3s:v1.20.2-k3s1   <span style="color:#e6db74">&#34;/bin/k3s agent&#34;</span>         <span style="color:#ae81ff">20</span> hours ago  Up <span style="color:#ae81ff">2</span> hours                                   k3d-dev-cluster-agent-0
d995147a0d08   rancher/k3s:v1.20.2-k3s1   <span style="color:#e6db74">&#34;/bin/k3s server --t…&#34;</span>   <span style="color:#ae81ff">20</span> hours ago  Up <span style="color:#ae81ff">2</span> hours                                   k3d-dev-cluster-server-0
</code></pre></div><p>Vemos que además de los nodos servidor y agente, <em>k3d</em> también ha desplegado un balanceador que expone la API de Kubernetes en un puerto aleatorio (en este caso, 32945). Si queremos especificar un puerto determinado, podemos usar la opción <code>--api-port</code> al crear el clúster.</p>
<h2 id="crear-un-clúster-a-partir-de-un-fichero-de-configuración">Crear un clúster (a partir de un fichero de configuración)</h2>
<p>Desde la versión v4.0.0 <em>k3d</em> permite especificar en un fichero de configuración cualquiera de las opciones que se pueden especificar desde línea de comando. Esto facilita todavía más integrar <em>k3d</em> en un <em>workflow</em> de integración contínua, por ejemplo, creando un clúster donde desplegar la nueva versión de la aplicación, realizar pruebas y destruirlo al finalizar.</p>
<p>La documentación oficial (en <a href="https://k3d.io/usage/configfile/">Config File</a>) proporciona un fichero de configuración de ejemplo como referencia; sin embargo, para crear un clúster como el que hemos creado manualmente en la sección anterior, el fichero es sencillamente:</p>
<blockquote>
<p>El fichero de configuración, en este caso, lo llamo <code>config-1s1a.yaml</code>.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#66d9ef">apiVersion</span>: k3d.io/v1alpha2 <span style="color:#75715e"># this will change in the future as we make everything more stable</span>
<span style="color:#66d9ef">kind</span>: Simple <span style="color:#75715e"># internally, we also have a Cluster config, which is not yet available externally</span>
<span style="color:#75715e"># name: mycluster # name that you want to give to your cluster (will still be prefixed with `k3d-`)</span>
<span style="color:#66d9ef">servers</span>: <span style="color:#ae81ff">1</span> <span style="color:#75715e"># same as `--servers 1`</span>
<span style="color:#66d9ef">agents</span>:  <span style="color:#ae81ff">1</span> <span style="color:#75715e"># same as `--agents 1`</span>
<span style="color:#66d9ef">options</span>:
  <span style="color:#66d9ef">kubeconfig</span>:
    <span style="color:#66d9ef">updateDefaultKubeconfig: true # add new cluster to your default Kubeconfig; same as `--kubeconfig-update-default` (default</span>: <span style="color:#66d9ef">true</span>)
    <span style="color:#66d9ef">switchCurrentContext: true # also set current-context to the new cluster&#39;s context; same as `--kubeconfig-switch-context` (default</span>: <span style="color:#66d9ef">true</span>)
</code></pre></div><p>Aunque el fichero de configuración permite especificar el nombre del clúster, podemos especificarlo desde la línea de comando al ejecutar el comando <code>k3d cluster create</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ k3d cluster create stable-cluster --config config-1s1a.yaml
INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Using config file config-1a1s.yaml           
INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Prep: Network                                
INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Created network <span style="color:#e6db74">&#39;k3d-stable-cluster&#39;</span>         
INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Created volume <span style="color:#e6db74">&#39;k3d-stable-cluster-images&#39;</span>   
INFO<span style="color:#f92672">[</span>0001<span style="color:#f92672">]</span> Creating node <span style="color:#e6db74">&#39;k3d-stable-cluster-server-0&#39;</span>  
INFO<span style="color:#f92672">[</span>0001<span style="color:#f92672">]</span> Creating node <span style="color:#e6db74">&#39;k3d-stable-cluster-agent-0&#39;</span>   
INFO<span style="color:#f92672">[</span>0001<span style="color:#f92672">]</span> Creating LoadBalancer <span style="color:#e6db74">&#39;k3d-stable-cluster-serverlb&#39;</span> 
INFO<span style="color:#f92672">[</span>0001<span style="color:#f92672">]</span> Starting cluster <span style="color:#e6db74">&#39;stable-cluster&#39;</span>            
INFO<span style="color:#f92672">[</span>0001<span style="color:#f92672">]</span> Starting servers...                          
INFO<span style="color:#f92672">[</span>0001<span style="color:#f92672">]</span> Starting Node <span style="color:#e6db74">&#39;k3d-stable-cluster-server-0&#39;</span>  
INFO<span style="color:#f92672">[</span>0010<span style="color:#f92672">]</span> Starting agents...                           
INFO<span style="color:#f92672">[</span>0010<span style="color:#f92672">]</span> Starting Node <span style="color:#e6db74">&#39;k3d-stable-cluster-agent-0&#39;</span>   
INFO<span style="color:#f92672">[</span>0020<span style="color:#f92672">]</span> Starting helpers...                          
INFO<span style="color:#f92672">[</span>0020<span style="color:#f92672">]</span> Starting Node <span style="color:#e6db74">&#39;k3d-stable-cluster-serverlb&#39;</span>  
INFO<span style="color:#f92672">[</span>0021<span style="color:#f92672">]</span> <span style="color:#f92672">(</span>Optional<span style="color:#f92672">)</span> Trying to get IP of the docker host and inject it into the cluster as <span style="color:#e6db74">&#39;host.k3d.internal&#39;</span> <span style="color:#66d9ef">for</span> easy access 
INFO<span style="color:#f92672">[</span>0027<span style="color:#f92672">]</span> Successfully added host record to /etc/hosts in 3/3 nodes and to the CoreDNS ConfigMap 
INFO<span style="color:#f92672">[</span>0027<span style="color:#f92672">]</span> Cluster <span style="color:#e6db74">&#39;stable-cluster&#39;</span> created successfully! 
INFO<span style="color:#f92672">[</span>0027<span style="color:#f92672">]</span> --kubeconfig-update-default<span style="color:#f92672">=</span>false --&gt; sets --kubeconfig-switch-context<span style="color:#f92672">=</span>false 
INFO<span style="color:#f92672">[</span>0027<span style="color:#f92672">]</span> You can now use it like this:                
kubectl config use-context k3d-stable-cluster
kubectl cluster-info
</code></pre></div><p>Validamos que el clúster se ha creado:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ k3d cluster list
NAME             SERVERS   AGENTS   LOADBALANCER
dev-cluster      1/1       2/2      true
stable-cluster   1/1       1/1      true
</code></pre></div><h2 id="conexión-a-los-clústers-creados-con-k3d">Conexión a los clústers creados con <strong>k3d</strong></h2>
<p>Por defecto <em>k3d</em> fusiona en el fichero <code>KUBECONFIG</code> (por defecto, en <code>$HOME/.kube/config</code>) la configuración de acceso al nuevo clúster. (<code>options.kubeconfig.updateDefaultKubeconfig: true</code>).</p>
<p>Puedes revisar la lista de todos los <em>contextos</em> definidos en el fichero de configuración:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl config get-contexts
CURRENT   NAME                 CLUSTER              AUTHINFO                   NAMESPACE
          k3d-dev-cluster      k3d-dev-cluster      admin@k3d-dev-cluster      
*         k3d-stable-cluster   k3d-stable-cluster   admin@k3d-stable-cluster
</code></pre></div><p>Como vemos, por defecto se cambia el contexto actual (<em>current-context</em>) a la configuración correspondiente al último clúster creado (el <em>contexto</em> activo es el indicado con un <code>*</code>).</p>
<p>Para usar otro contexto (e interactuar con otro clúster) usa:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ kubectl config use-context k3d-dev-cluster
Switched to context <span style="color:#e6db74">&#34;k3d-dev-cluster&#34;</span>.
</code></pre></div><h2 id="añadir-o-eliminar-nodos-al-clúster">Añadir (o eliminar) nodos al clúster</h2>
<p><strong>k3d</strong> proporciona el comando <code>k3d node create</code> con el que añadimos nuevos nodos al clúster.</p>
<p>Para añadir un nodo agente al clúster <code>dev-cluster</code>:</p>
<blockquote>
<p>k3d añade el prefijo k3d- y un sufijo numérico indicando el número de réplicas.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ k3d cluster list
NAME          SERVERS   AGENTS   LOADBALANCER
dev-cluster   1/1       1/1      true
$ export CLUSTER_NAME<span style="color:#f92672">=</span>dev-cluster
$ k3d node create dev-cluster-agent-1 --cluster $CLUSTER_NAME --role agent
INFO<span style="color:#f92672">[</span>0000<span style="color:#f92672">]</span> Starting Node <span style="color:#e6db74">&#39;k3d-dev-cluster-agent-1-0&#39;</span>
</code></pre></div><p>Validamos que se ha creado el nuevo nodo con el rol de agente:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ k3d node list
NAME                        ROLE           CLUSTER       STATUS
k3d-dev-cluster-agent-0     agent          dev-cluster   running
k3d-dev-cluster-agent-1-0   agent          dev-cluster   running
k3d-dev-cluster-server-0    server         dev-cluster   running
k3d-dev-cluster-serverlb    loadbalancer   dev-cluster   running
</code></pre></div><h2 id="resumen">Resumen</h2>
<p>Como ves, la creación de clústers usando <strong>k3d</strong> reduce al mínimo la fricción a la hora de generar clústers de Kubernetes para realizar pruebas sin consumir demasiados recursos. Por ello, es una solución conveniente para realizar pruebas prácticamente en cualquier sitio, desde localmente en el portátil del desarrollador, una Raspberry Pi o una instancia en algún servicio cloud.</p></div>

  <aside class="p-share">
  <a href="http://twitter.com/intent/tweet?url=https%3a%2f%2fonthedock.github.io%2fpost%2f210321-k3d-k3s-en-docker%2f&text=k3d%3a%20k3s%20en%20Docker%20%28o%20la%20manera%20m%c3%a1s%20r%c3%a1pida%20de%20montar%20cl%c3%basters%20de%20Kubernetes%20para%20desarrollo%29&tw_p=tweetbutton" title="Twitterでシェア" class="tw" target="_blank" rel="nofollow"></a>
  <a href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fonthedock.github.io%2fpost%2f210321-k3d-k3s-en-docker%2f&t=k3d%3a%20k3s%20en%20Docker%20%28o%20la%20manera%20m%c3%a1s%20r%c3%a1pida%20de%20montar%20cl%c3%basters%20de%20Kubernetes%20para%20desarrollo%29" title="Facebookでシェア" class="fb" target="_blank" rel="nofollow"></a>
  <a href="http://line.me/R/msg/text/?k3d%3a%20k3s%20en%20Docker%20%28o%20la%20manera%20m%c3%a1s%20r%c3%a1pida%20de%20montar%20cl%c3%basters%20de%20Kubernetes%20para%20desarrollo%29 https%3a%2f%2fonthedock.github.io%2fpost%2f210321-k3d-k3s-en-docker%2f" title="LINEでシェア" class="ln" target="_blank" rel="nofollow"></a>
  <a href="http://b.hatena.ne.jp/add?mode=confirm&url=https%3a%2f%2fonthedock.github.io%2fpost%2f210321-k3d-k3s-en-docker%2f&title=k3d%3a%20k3s%20en%20Docker%20%28o%20la%20manera%20m%c3%a1s%20r%c3%a1pida%20de%20montar%20cl%c3%basters%20de%20Kubernetes%20para%20desarrollo%29" title="はてなブックマーク" class="ht" target="_blank" rel="nofollow"></a>
  <div class="searchbar">
      <iframe src="https://duckduckgo.com/search.html?site=https://onthedock.github.io/&prefill=Busca en este sitio usando DuckDuckGo" style="width: 25em;height: 48px" frameborder="0"></iframe>
    </div>
</aside>


  <footer class="article-footer">
    <section>
      <ol class="p-crumb">
        <li><a href="https://onthedock.github.io/">On The Dock</a></li>
        
        <li itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb"><a href="https://onthedock.github.io/post/" itemprop="url"><span itemprop="title">post</span></a></li>
        
        <li>k3d: k3s en Docker (o la manera más rápida de montar clústers de Kubernetes para desarrollo)</li>
      </ol>

      
      
      
      <ul class="p-facts">
        <li>
          <header><a href="https://onthedock.github.io/categories/">categories</a></header>
          <ul>
            
            <li><a href="https://onthedock.github.io/categories/dev/">dev</a></li>
            
          </ul>
        </li>
      </ul>
      
      
      
      <ul class="p-facts">
        <li>
          <header><a href="https://onthedock.github.io/tags/">tags</a></header>
          <ul>
            
            <li><a href="https://onthedock.github.io/tags/kubernetes/">kubernetes</a></li>
            
            <li><a href="https://onthedock.github.io/tags/k3s/">k3s</a></li>
            
            <li><a href="https://onthedock.github.io/tags/k3d/">k3d</a></li>
            
            <li><a href="https://onthedock.github.io/tags/docker/">docker</a></li>
            
          </ul>
        </li>
      </ul>
      
      
    </section>
  </footer>
</article>

<article>
  <div id="disqus_thread"></div>
  <script>
  
  

  

  (function() { 
  var d = document, s = d.createElement('script');
  s.src = 'https://onthedock.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                              

</article>



  
  
  <section>
    <header><span>Latests</span></header>
    <ul class="p-articles thin">
      <li><article class="li sm article-fca7a454728b2f5a01888983d70e6476">
  <div class="header-wrapper">
    <a href="https://onthedock.github.io/post/210305-eliminar-ns-terminanting/" class="thumbnail" title="Eliminar namespace encallado en Terminanting"></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="https://onthedock.github.io/post/210305-eliminar-ns-terminanting/">Eliminar namespace encallado en Terminanting</a></h2>
        <ul class="p-facts">
          <li><time datetime="2021-03-05T17:53:31JST">5 Mar 2021</time></li>
          <li><a href="https://onthedock.github.io/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li><li><article class="li sm article-32fa31070432a9a2d86d78f72a8244ad">
  <div class="header-wrapper">
    <a href="https://onthedock.github.io/post/210221-analiza-los-objetos-de-kubernetes-periodicamente-con-kubelinter-y-un-cronjob/" class="thumbnail" title="Analiza los objetos de Kubernetes con Kubelinter y Cronjobs"></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="https://onthedock.github.io/post/210221-analiza-los-objetos-de-kubernetes-periodicamente-con-kubelinter-y-un-cronjob/">Analiza los objetos de Kubernetes con Kubelinter y Cronjobs</a></h2>
        <ul class="p-facts">
          <li><time datetime="2021-02-21T12:08:02JST">21 Feb 2021</time></li>
          <li><a href="https://onthedock.github.io/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li><li><article class="li sm article-e447bc414104c15405ae169ace8c2b29">
  <div class="header-wrapper">
    <a href="https://onthedock.github.io/post/210212-runasuser-y-readonlyrootfilesystem/" class="thumbnail" title="Seguridad en Kubernetes: runAsUser y readOnlyRootFilesystem"></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="https://onthedock.github.io/post/210212-runasuser-y-readonlyrootfilesystem/">Seguridad en Kubernetes: runAsUser y readOnlyRootFilesystem</a></h2>
        <ul class="p-facts">
          <li><time datetime="2021-02-12T23:02:05JST">12 Feb 2021</time></li>
          <li><a href="https://onthedock.github.io/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li><li><article class="li sm article-38e84f875db85488c523f3257aba8fdd">
  <div class="header-wrapper">
    <a href="https://onthedock.github.io/post/210212-kubelinter/" class="thumbnail" title="KubeLinter: identifica malas configuraciones en los objetos de Kubernetes"></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="https://onthedock.github.io/post/210212-kubelinter/">KubeLinter: identifica malas configuraciones en los objetos de Kubernetes</a></h2>
        <ul class="p-facts">
          <li><time datetime="2021-02-12T21:36:01JST">12 Feb 2021</time></li>
          <li><a href="https://onthedock.github.io/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li>
    </ul>
  </section>
  
</div>


    </main>

    

    <footer class="l-footer">
      <div class="l-container">
        <p class="copyright-notice">Handmade with &#9829; by Xavi Aznar</p>
        <aside>
          <p class="attribution">Powered by <a href="https://gohugo.io/">Hugo</a> using <a href="https://github.com/dim0627/hugo_theme_aglaus" class="h-logo">Aglaus</a> (designed by <a href="http://yet.unresolved.xyz/">Daisuke Tsuji</a>).</p>
        </aside>
      </div>
    </footer>

    <a href="#" class="p-movetop" title="ページ上部へ戻る" rel="nofollow"></a>
  </body>
</html>

