<!DOCTYPE html>
<html ⚡>
  <head>
    <meta charset="utf-8">
<meta name="pinterest" content="nopin">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name="theme-color" content="#263238">

<meta name="generator" content="Hugo 0.30.2" />

<link rel="apple-touch-icon" href="https://onthedock.github.io/images/logo.png">


<link rel="canonical" href="https://onthedock.github.io/post/170930-nuevos-problemas-para-construir-la-imagen-para-rpi/">


    
    <link href="https://fonts.googleapis.com/css?family=Lobster|Lato:400,700" rel="stylesheet">
    
    <title>Nuevos problemas al construir la imagen con Caddy y PHP, ahora para Raspberry Pi - On The Dock</title>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    
    <script async custom-element="amp-twitter" src="https://cdn.ampproject.org/v0/amp-twitter-0.1.js"></script>
<script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
<script async custom-element="amp-ad" src="https://cdn.ampproject.org/v0/amp-ad-0.1.js"></script>

    
<meta name="description" content="&lt;p&gt;En la entrada anterior &lt;a href=&#34;https://onthedock.github.io/post/170924-dokuwiki_en_un_contenedor_notas/&#34;&gt;Dokuwiki en un contendor&lt;/a&gt; dejaba constancia de los problemas que encontré creando una imagen para ejecutar Dokuwiki en un contenedor.&lt;/p&gt;&lt;p&gt;Al final de la entrada indicaba que la creación de la misma imagen, pero para ARM sería tan sencillo como cambiar la imagen base. &lt;strong&gt;Pues no.&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Como he tenido que revisar a fondo los pasos que seguí -en particular para configurar la carpeta desde donde Caddy publica los ficheros-, he introducido algunos cambios que simplifiquen y mejoren el uso de la imagen.&lt;/p&gt;&lt;p&gt;&lt;/p&gt;">

<meta property="og:title" content="Nuevos problemas al construir la imagen con Caddy y PHP, ahora para Raspberry Pi - On The Dock">
<meta property="og:type" content="article">
<meta property="og:url" content="https://onthedock.github.io/post/170930-nuevos-problemas-para-construir-la-imagen-para-rpi/">
<meta property="og:image" content="https://onthedock.github.io/images/docker.png">
<meta property="og:site_name" content="On The Dock">
<meta property="og:description" content="&lt;p&gt;En la entrada anterior &lt;a href=&#34;https://onthedock.github.io/post/170924-dokuwiki_en_un_contenedor_notas/&#34;&gt;Dokuwiki en un contendor&lt;/a&gt; dejaba constancia de los problemas que encontré creando una imagen para ejecutar Dokuwiki en un contenedor.&lt;/p&gt;&lt;p&gt;Al final de la entrada indicaba que la creación de la misma imagen, pero para ARM sería tan sencillo como cambiar la imagen base. &lt;strong&gt;Pues no.&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Como he tenido que revisar a fondo los pasos que seguí -en particular para configurar la carpeta desde donde Caddy publica los ficheros-, he introducido algunos cambios que simplifiquen y mejoren el uso de la imagen.&lt;/p&gt;&lt;p&gt;&lt;/p&gt;">
<meta property="og:locale" content="ja_JP">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="On The Dock">
<meta name="twitter:url" content="https://onthedock.github.io/post/170930-nuevos-problemas-para-construir-la-imagen-para-rpi/">
<meta name="twitter:title" content="Nuevos problemas al construir la imagen con Caddy y PHP, ahora para Raspberry Pi - On The Dock">
<meta name="twitter:description" content="&lt;p&gt;En la entrada anterior &lt;a href=&#34;https://onthedock.github.io/post/170924-dokuwiki_en_un_contenedor_notas/&#34;&gt;Dokuwiki en un contendor&lt;/a&gt; dejaba constancia de los problemas que encontré creando una imagen para ejecutar Dokuwiki en un contenedor.&lt;/p&gt;&lt;p&gt;Al final de la entrada indicaba que la creación de la misma imagen, pero para ARM sería tan sencillo como cambiar la imagen base. &lt;strong&gt;Pues no.&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Como he tenido que revisar a fondo los pasos que seguí -en particular para configurar la carpeta desde donde Caddy publica los ficheros-, he introducido algunos cambios que simplifiquen y mejoren el uso de la imagen.&lt;/p&gt;&lt;p&gt;&lt;/p&gt;">
<meta name="twitter:image" content="https://onthedock.github.io/images/docker.png">


<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "NewsArticle",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id":"https://onthedock.github.io/"
    },
    "headline": "Nuevos problemas al construir la imagen con Caddy y PHP, ahora para Raspberry Pi - On The Dock",
    "image": {
      "@type": "ImageObject",
      "url": "https://onthedock.github.io/images/docker.png",
      "height": 800,
      "width": 800
    },
    "datePublished": "2017-09-30T17:30:45JST",
    "dateModified": "2017-09-30T17:30:45JST",
    "author": {
      "@type": "Person",
      "name": "On The Dock"
    },
    "publisher": {
      "@type": "Organization",
      "name": "On The Dock",
      "logo": {
        "@type": "ImageObject",
        "url": "https://onthedock.github.io/images/logo.png",
        "width": 600,
        "height": 60
      }
    },
    "description": "<p>En la entrada anterior <a href="https://onthedock.github.io/post/170924-dokuwiki_en_un_contenedor_notas/">Dokuwiki en un contendor</a> dejaba constancia de los problemas que encontré creando una imagen para ejecutar Dokuwiki en un contenedor.</p>

<p>Al final de la entrada indicaba que la creación de la misma imagen, pero para ARM sería tan sencillo como cambiar la imagen base. <strong>Pues no.</strong></p>

<p>Como he tenido que revisar a fondo los pasos que seguí -en particular para configurar la carpeta desde donde Caddy publica los ficheros-, he introducido algunos cambios que simplifiquen y mejoren el uso de la imagen.</p>

<p></p>"
  }
</script>


    <style amp-custom>
      html { font-size: 18px;}@media (max-width: 768px) { html { font-size: 15px; }}body { font-family: Lato,'Hiragino Kaku Gothic Pro',メイリオ,Meiryo,sans-serif; font-size: inherit; margin: 0; color: #263238;}html, body { margin: 0;}a { text-decoration: none; color: #e91e63;}p { margin: 0;}ul,ol { margin: 0; padding: 0;}h1, h2, h3, h4, h5, h6 { margin: 0; font-weight: 700;}h1 { font-size: 1.8rem; line-height: 2rem; margin: 1.5rem 0; }h2 { font-size: 1.4rem; line-height: 2rem; margin: 1.5rem 0; }h3 { font-size: 1.2rem; line-height: 1.5rem; margin: 1.5rem 0; }h4, h5, h6 { font-size: 1rem; line-height: 1.5rem; margin: 1.5rem 0; }.clearfix::after { content: ''; display: block; clear: both;}main { display: block;}/* Layouts */.l-header { padding: .5rem 0; margin-bottom: 2rem; border-bottom: 1px dashed #cfd8dc; text-align: center;}.l-footer { font-size: .8rem; padding: 1rem 0; border-top: 1px dashed #cfd8dc;}.l-footer .copyright-notice,.l-footer .attribution { text-align: center;}.l-container { max-width: 42rem; margin: 0 auto; padding: 0 1rem;}/* Parts:logo */.p-logo { font-family: Lobster, cursive;}.p-logo a { color: #000; font-size: 1.6rem; line-height: 2rem;}/* Parts:section */section { border-top: 2px solid #eceff1; padding: 1.5rem 0;}section>header { text-transform: uppercase; font-weight: 700; margin-bottom: 2rem; text-align: center;}section>header span { display: inline-block; background-color: #000; color: #fff; letter-spacing: 3px; font-size: .7rem; padding: .5rem .75rem;}/* Parts:facts */.p-facts { list-style: none; font-size: .8rem; margin-bottom: 1rem;}.p-facts:last-child { margin-bottom: 0;}.p-facts li { display: inline-block; margin-right: .5rem; text-transform: uppercase;}.p-facts li header { margin-bottom: .25rem; font-weight: 700;}.p-facts li header a { color: #000; text-decoration: underline;}.p-facts li li { display: inline-block; margin-right: .5rem;}.p-facts li li::after { content: ',';}.p-facts li li:last-child::after { content: '';}/* Parts:crumb */.p-crumb { list-style: none; margin-bottom: 1rem; font-size: .8rem; text-transform: uppercase; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.p-crumb:last-child { margin-bottom: 0;}.p-crumb li { display: inline;}.p-crumb li::after { content: '›'; margin: 0 .5rem;}.p-crumb li:last-child::after { content: '';}/* Parts:page-title */.p-page-title { margin-bottom: 2rem;}.p-page-title .title { margin-bottom: .5rem;}/* Parts:share */.p-share { margin-bottom: 1.5rem;}.p-share a { display: inline-block; text-align: center; padding: .5rem .5rem; margin-right: .25rem; font-size: .6rem; background-color: #eceff1; font-weight: 700;}.p-share a.ht { color: #00a4de; }.p-share a.fb { color: #3b5998; }.p-share a.tw { color: #1da1f2; }.p-share a.gp { color: #dd4b39; }.p-share a.ln { color: #00c300; }.p-share a.ht::before { content: 'Hatena'; }.p-share a.fb::before { content: 'Facebook'; }.p-share a.tw::before { content: 'Twitter'; }.p-share a.gp::before { content: 'Google+'; }.p-share a.ln::before { content: 'LINE'; }/* Parts:terms */.p-terms { padding-left: 2rem;}/* Parts:paginator */.p-paginator { text-align: center; margin-bottom: 3rem; padding-top: 2rem;}.p-paginator a { display: inline-block; border: 2px solid #eceff1; color: #263238; line-height: 2rem; padding: 0 1rem;}/* Parts:article */.p-articles { list-style: none;}.p-articles>li { margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px dashed #cfd8dc;}.p-articles>li:last-child { border-bottom: none; padding-bottom: 0;}.p-articles.thin>li { margin-bottom: 1rem; padding-bottom: 1rem;}article .article-header { display: table-cell; height: 6rem; vertical-align: middle;}article .title { margin: 0; margin-bottom: .5rem; font-size: 1.4rem; line-height: 2rem;}article .title a { color: #000;}article .header-wrapper { margin-bottom: 1.5rem;}article .thumbnail { display: block; background-position: center; background-size: cover; background-image: url(https://onthedock.github.io/images/default.jpg); width: 6rem; height: 6rem; border-radius: 50%; box-shadow: 0 0 3px 0 #333 inset; float: left; margin-right: 1rem;}article .summary { margin-bottom: 1.5rem;}article .readmore { text-align: center;}article .readmore a { font-size: .8rem; color: #000; text-decoration: underline;}article.li.sm .header-wrapper { margin-bottom: 0;}.article-body h2 { padding: 1rem 0; color: #55bbbb; border-bottom: 2px solid #eceff1;}.article-body h2:first-child { margin-top: 0; }.article-body h3 { color: #8997e4; font-style: italic;}.article-body h4 { border-left: solid .25rem #cddc39; padding: 0 .5rem;}.article-body p { margin: 1.5rem 0; line-height: 1.5rem;}.article-body a { text-decoration: underline;}.article-body ul,.article-body ol { padding-left: 1.5rem;}.article-body li { line-height: 2rem;}.article-body code { display: inline-block; font-family: Menlo, consolas, monospace; background-color: #eceff1; font-size: .8rem; padding: 0 .5rem; line-height: 1.5rem;}.article-body pre { margin: 1.5rem 0; padding: 1.5rem; font-size: .8rem; background-color: #263238; color: #fff; overflow: auto;}.article-body pre code { background-color: transparent;}.article-body blockquote { /* margin: 1.2rem 0; padding: .5rem 0; */ /*font-size: .8rem;*/ border-top: 1px solid #eceff1; border-bottom: 1px solid #eceff1; color: #607d8b;}.article-body blockquote p { margin: .5rem 0; line-height: 1.5rem;}.article-body strong { /*box-shadow: 0 -.5rem 0 0 #f06292 inset;*/ font-style: bold; font-weight: 700; color: #ff5722;}.article-body em { font-style: normal; /*font-weight: 700;*/ color: #00c300;}.article-body figure { margin: 1.5rem -2rem; }.article-body figure.left,.article-body figure.right { width: 15rem; height: 12rem; margin-top: 0; margin-left: 0; margin-right: 0;}.article-body figure.left { float: left; margin-right: 1rem; margin-left: -2rem; }.article-body figure.right { float: right; margin-left: 1rem; margin-right: -2rem; }@media (max-width: 768px) { .article-body figure { margin: 1.5rem -1rem; } .article-body figure.left, .article-body figure.right { float: none; margin: 0 -1rem; width: auto; height: auto; }}.article-body figcaption { padding: .5rem 0; font-size: .8rem; text-align: center;}.article-body figcaption a { color: #263238;}

       .article-2fc73bdfb18aaf2eb89944fb4f7d53de .thumbnail { background-image: url(https://onthedock.github.io/images/gogs.png);  }  .article-70a1a0028c7c78526f004c0e3218a2b3 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-f81b2bb759a18deaa3b5575087686fe7 .thumbnail { background-image: url(https://onthedock.github.io/images/gogs.png);  }  .article-156dcec052e59d7d9f0de2250fda46f4 .thumbnail { background-image: url(https://onthedock.github.io/images/dokuwiki-on-docker.png);  }  .article-f831baebaad56b8e3d70750749393da3 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-df14f92fc6edab1c8632e66ef7c7e5a6 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-516ab75e14eb7886aaab03ff75dbfc6b .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-d1ead2ec3d26cb7f91ef8234915eb13f .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-0b9c6f0820f2306f6cc2bfd170dccb8e .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-1cbc9cfd0ad3798b23d19eac020b3153 .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-a32274b07ce43fef61c7f19e4b68f650 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-9b0b3a180af20b5c091134d23cb6d383 .thumbnail { background-image: url(https://onthedock.github.io/images/minio.jpg);  }  .article-b20735633157cb1e57eb0c1d05406149 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-d1e335a06f765bffda53d2e123044b27 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-c36c64b9d6ce0d2c95381976831c3160 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-ee7d8acecc9de179b9d1cecb3d253215 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-2480be47fe45cfc13b07c86c32ed8cda .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-99a6578fdc273f40a61d182bcb5917c4 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-3ffff09a2dd1f953bbb8624d88756829 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-0a9cef5c4637bd946188e37439fef69c .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-42a206d287914317761f7749b964ddb2 .thumbnail { background-image: url(https://onthedock.github.io/images/alpine.png);  }  .article-85dee6c250520e561ebc93740f1d514f .thumbnail { background-image: url(https://onthedock.github.io/images/alpine.png);  }  .article-a65000ba68f97000bb927be3f88f75bd .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-2de6ff3b0144ea18b2ef056107448a33 .thumbnail { background-image: url(https://onthedock.github.io/images/yaml.png);  }  .article-a8aea2191f0d8d238ab6217feba51ac3 .thumbnail { background-image: url(https://onthedock.github.io/images/vagrant.png);  }  .article-67cd76b76e108b6604b344e92a3c329a .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-d341a5f8cd54b9da7a3a6d1168365c25 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-59e1fe22eaedce05afe517780f87cc98 .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-87ee3835fe3b255e8566c3bfed2bd38b .thumbnail { background-image: url(https://onthedock.github.io/images/portainer.png);  }  .article-086bb6242700303c8a958c5e74df0ca9 .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-4c6b9124141ca1a8135b9177248b7e15 .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-911698c11286b3ef9eb1a11440c09845 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-6a0861472d6f0696079c81e3710d5fe8 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-40b8655184d8e4a2ca3650aece49e845 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-857a5f627557e7d92f1386f7c6e04dee .thumbnail { background-image: url(https://onthedock.github.io/images/raspberry_pi.png);  }  .article-4db85da082f771e8fb9029adad4173ec .thumbnail { background-image: url(https://onthedock.github.io/images/raspberry_pi.png);  }  .article-b69159ccecf58bff548bbd08481b6e15 .thumbnail { background-image: url(https://onthedock.github.io/images/raspberry_pi.png);  }  .article-da222607e970c37b0b59d8011a2e3398 .thumbnail { background-image: url(https://onthedock.github.io/images/portainer.png);  }  .article-7b36708a64c36890ceb1bf481f3de1fa .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-d68e08dcca5eafff4ae0d8d06280bf02 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-8ff87e4d24c357bbee842dd088ef4cde .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-d0ca4b0abe6c0c6d22baa800e3fc9935 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-63c13529eb1936073e0adc09d7e35b59 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-2e821bde62a219fe0b94f62e989269e7 .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-df564c824db9099fd85c925ad9635cda .thumbnail { background-image: url(https://onthedock.github.io/images/raspberry_pi.png);  }  .article-203d2d443889d9d70ca2ad9abcca49aa .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-526bade0815ac377e81216604b97c5f7 .thumbnail { background-image: url(https://onthedock.github.io/images/github.png);  }  .article-3d9c586728a0009cb0621b0368120462 .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-160ee3ec04bb73e590f125b42640b34b .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-c862ac2fb3511b386b4247a80aa6b90b .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-8a50a2d4216b1a3b2b46c646bd24c5e9 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-f027d2889032f918da8e3cc9c03169e0 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-6db4ecfe853552466ce5a71b1221a2a0 .thumbnail { background-image: url(https://onthedock.github.io/images/hypriot.png);  } 
    </style>
  </head>

  <body>
    
    
    

    <header class="l-header">
      <div class="l-container">
        <div class="h-logo p-logo">
          <a href="https://onthedock.github.io/" class="h-logo">On The Dock</a>
          <p class="h-logo">Un blog sobre Docker, Kubernetes, DevOps y Raspberry Pi por Xavier Aznar</p>
        </div>
      </div>
    </header>

    <main>
      
<div class="l-container">
  <article class="single article-d1ead2ec3d26cb7f91ef8234915eb13f">
  <div class="header-wrapper">
    <a href="https://onthedock.github.io/post/170930-nuevos-problemas-para-construir-la-imagen-para-rpi/" class="thumbnail" title="Nuevos problemas al construir la imagen con Caddy y PHP, ahora para Raspberry Pi"></a>
    <header class="article-header">
      <div class="clearfix">
        <h1 class="title">Nuevos problemas al construir la imagen con Caddy y PHP, ahora para Raspberry Pi</h1>
        <ul class="p-facts">
          <li><time datetime="2017-09-30T17:30:45JST">30 Sep 2017</time></li>
          <li><a href="https://onthedock.github.io/post/">post</a></li>
          
          <li>Xavier Aznar</li>
        </ul>
      </div>
    </header>
  </div>

  <div class="article-body"><p>En la entrada anterior <a href="https://onthedock.github.io/post/170924-dokuwiki_en_un_contenedor_notas/">Dokuwiki en un contendor</a> dejaba constancia de los problemas que encontré creando una imagen para ejecutar Dokuwiki en un contenedor.</p>

<p>Al final de la entrada indicaba que la creación de la misma imagen, pero para ARM sería tan sencillo como cambiar la imagen base. <strong>Pues no.</strong></p>

<p>Como he tenido que revisar a fondo los pasos que seguí -en particular para configurar la carpeta desde donde Caddy publica los ficheros-, he introducido algunos cambios que simplifiquen y mejoren el uso de la imagen.</p>

<p></p>

<h2 id="imagen-base">Imagen base</h2>

<p>Lo que originalmente debía ser tan sencillo como un cambio de imagen base, no ha funcionado a la primera.</p>

<p>La imagen base que pensaba utilizar era <a href="https://hub.docker.com/r/xaviaznar/rpi-alpine-base/">xaviaznar/rpi-alpine-base</a>. Esta imagen está basada en <a href="https://hub.docker.com/r/hypriot/rpi-alpine-scratch/">hypriot/rpi-alpine-scratch</a>, pero resulta que esta imagen no se actualiza desde hace más de un año:</p>

<figure>
  <amp-img src="https://onthedock.github.io/images/170930/alpine-scratch.png" alt="Nuevos problemas al construir la imagen con Caddy y PHP, ahora para Raspberry Pi images/170930/alpine-scratch.png" width=640 height=400 layout="responsive"></amp-img>
  
</figure>


<p>Así que los paquetes de PHP 7 no estaban todavía incluidos en los repositorios y la construcción de la imagen ha fallado.</p>

<p>Afortunadamente existen una imagenes <em>semi-oficiales</em> para ARM de la mano de <a href="https://hub.docker.com/u/arm32v6/">arm32v6</a> (para Raspberry Pi &ldquo;1&rdquo;) y <a href="https://hub.docker.com/u/arm32v7/">arm32v7</a> (para las Raspberry 2 y 3).</p>

<p>Así que para la RPi 1, he usado como base <a href="https://hub.docker.com/r/arm32v6/alpine/">arm32v6/alpine</a>.</p>

<p>La dependencia de imágenes base de terceros es uno de los problemas que hay que tener en cuenta en el diseño de los contenedores. Esto es especialmente sensible para equipos ARM para los cuales todavía no hay siempre una imagen oficial del desarrollador del producto y se depende de imágenes creadas por voluntarios.</p>

<h2 id="rutas-de-nuevo">Rutas (de nuevo)</h2>

<p>En la entrada anterior los ficheros del wiki se encontraba en la carpeta <code>~/dokuwiki</code>, por lo que <a href="https://github.com/onthedock/alpine-caddy-php/blob/master/runWiki.sh">montaba el volumen en comando <code>docker run</code></a> el volumen mediante <code>-v /home/operador/dokuwiki:/var/www</code>. En el fichero <code>Caddyfile</code> sin embargo, la raíz de las carpetas publicadas por Caddy <code>root /var/www/wiki</code>.</p>

<p>Es decir, en el sistema de ficheros locales tenía <code>~/dokuwiki/wiki/{ficheros php}</code>, pero debido a la similitud de los nombres, pensaba que tenía <code>~/dokuwiki/{ficheros php}</code>, por lo que he estado un buen rato intentando averiguar el porqué de los errores 404 que mostraba el navegador, los logs, etc.</p>

<p>Para evitar este tipo de errores en el futuro, la raíz de las carpetas públicas en Caddy será siempre <code>/var/www</code>. Los ficheros <em>locales</em> siempre estarán en una carpeta llamada <code>www</code>, que será la que se monte sobre ésta carpeta del contenedor.</p>

<p>Otro punto que hay que tener en cuenta es que el contenido de la carpeta del contenedor sobre la que se monta la carpeta del <em>host</em> no se fusiona con el contenido de ésta: sólo son visibles los ficheros de la carpeta del <em>host</em> montada en el contenedor.</p>

<p>En mi caso, por ejemplo, al construir la imagen se copian los ficheros <code>index.htm</code> y <code>phpinfo.php</code> en <code>/var/www</code>. Pero cuando se monta la carpeta <code>~/wiki</code> en <code>/var/wwww</code>, sólo aparecen los ficheros presentes en <code>~/wiki</code>. Los ficheros <code>index.php</code> y <code>phpinfo.php</code> sólo son <em>visibles</em> si no se monta un volumen en el contenedor.</p>

<h3 id="file-not-found-al-acceder-a-http-iphost-puerto">File not found al acceder a http://$IPHOST:puerto/</h3>

<p>Al acceder a la URL del servidor web sin indicar el nombre del fichero, por defecto se busca un fichero llamado <code>index.html</code>. En mi caso, como el fichero se llamaba <code>index.htm</code> (sin la &ldquo;l&rdquo; final), se mostraba un error <code>File Not Found</code>.</p>

<p>He renombrado el fichero de <code>index.htm</code> a <code>index.html</code> después de <a href="https://caddyserver.com/docs/index">consultar la documentación de Caddy</a> para que no suceda. En el fichero <code>index.html</code> he incluido un enlace al fichero <code>phpinfo.php</code> para verificar la configuración de PHP en el contenedor.</p>

<h2 id="volúmenes-compartidos-entre-el-host-y-el-contenedor">Volúmenes compartidos entre el host y el contenedor</h2>

<p>Para simplificar la organización de las carpetas montadas en los contenedores, he creado una carpeta llamada <code>/shared</code>, en la raíz del árbol de carpetas. Dentro de esta carpeta habrá una carpeta para cada contenedor que tenga un volumen local montado.</p>

<p>Para el caso anterior, si el contenedor tiene por nombre <code>wiki</code>, cada uno de los volúmenes montados será una subcarpeta de ésta.</p>

<p>Un ejemplo:</p>

<pre><code class="language-txt">/shared/
├── wiki/
│   ├── www/
│   └── logs/
├── otro_contenedor/
│   ├── foo/
│   └── bar/
</code></pre>

<p>Este cambio hace que tenga que modificar todos los <em>lanzadores</em> -como el <code>runWiki.sh</code>-, aunque es un problema menor; una vez que el contenedor se ha lanzado, se puede gestionar el arranque y la parada mediante <code>docker start/stop $NOMBRE_CONTENEDOR</code>.</p>

<h2 id="siguientes-pasos">Siguientes pasos</h2>

<p>Una vez he resuelto todos los problemas que han ido apareciendo en esta fase de desarrollo, el siguiente paso es documentar todos los pasos -correctos- que hay que dar para obtener tanto la imagen con Caddy y PHP como para usarla en un contenedor sirviendo una aplicación web en PHP.</p>

<blockquote>
<p>Actualización: Ya está lista la guía paso a paso: <a href="https://onthedock.github.io/post/170930-como-crear-una-imagen-con-caddy-y-php/">Cómo crear una imagen con Caddy y PHP</a></p>
</blockquote></div>

  <aside class="p-share">
  <a href="http://b.hatena.ne.jp/add?mode=confirm&url=https%3a%2f%2fonthedock.github.io%2fpost%2f170930-nuevos-problemas-para-construir-la-imagen-para-rpi%2f&title=Nuevos%20problemas%20al%20construir%20la%20imagen%20con%20Caddy%20y%20PHP%2c%20ahora%20para%20Raspberry%20Pi" title="はてなブックマーク" class="ht" target="_blank" rel="nofollow"></a>
  <a href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fonthedock.github.io%2fpost%2f170930-nuevos-problemas-para-construir-la-imagen-para-rpi%2f&t=Nuevos%20problemas%20al%20construir%20la%20imagen%20con%20Caddy%20y%20PHP%2c%20ahora%20para%20Raspberry%20Pi" title="Facebookでシェア" class="fb" target="_blank" rel="nofollow"></a>
  <a href="http://twitter.com/intent/tweet?url=https%3a%2f%2fonthedock.github.io%2fpost%2f170930-nuevos-problemas-para-construir-la-imagen-para-rpi%2f&text=Nuevos%20problemas%20al%20construir%20la%20imagen%20con%20Caddy%20y%20PHP%2c%20ahora%20para%20Raspberry%20Pi&tw_p=tweetbutton" title="Twitterでシェア" class="tw" target="_blank" rel="nofollow"></a>
  <a href="https://plus.google.com/share?url=https%3a%2f%2fonthedock.github.io%2fpost%2f170930-nuevos-problemas-para-construir-la-imagen-para-rpi%2f" title="Google Plusでシェア" class="gp" target="_blank" rel="nofollow"></a>
  <a href="http://line.me/R/msg/text/?Nuevos%20problemas%20al%20construir%20la%20imagen%20con%20Caddy%20y%20PHP%2c%20ahora%20para%20Raspberry%20Pi https%3a%2f%2fonthedock.github.io%2fpost%2f170930-nuevos-problemas-para-construir-la-imagen-para-rpi%2f" title="LINEでシェア" class="ln" target="_blank" rel="nofollow"></a>
</aside>


  <footer class="article-footer">
    <section>
      <ol class="p-crumb">
        <li><a href="https://onthedock.github.io/">On The Dock</a></li>
        
        <li itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb"><a href="https://onthedock.github.io/post/" itemprop="url"><span itemprop="title">post</span></a></li>
        
        <li>Nuevos problemas al construir la imagen con Caddy y PHP, ahora para Raspberry Pi</li>
      </ol>

      
      
      
      <ul class="p-facts">
        <li>
          <header><a href="https://onthedock.github.io/categories/">categories</a></header>
          <ul>
            
            <li><a href="https://onthedock.github.io/categories/dev/">dev</a></li>
            
          </ul>
        </li>
      </ul>
      
      
      
      <ul class="p-facts">
        <li>
          <header><a href="https://onthedock.github.io/tags/">tags</a></header>
          <ul>
            
            <li><a href="https://onthedock.github.io/tags/raspberry-pi/">raspberry pi</a></li>
            
            <li><a href="https://onthedock.github.io/tags/linux/">linux</a></li>
            
            <li><a href="https://onthedock.github.io/tags/docker/">docker</a></li>
            
          </ul>
        </li>
      </ul>
      
      
    </section>
  </footer>
</article>



  
  
  <section>
    <header><span>Latests</span></header>
    <ul class="p-articles thin">
      <li><article class="li sm article-2fc73bdfb18aaf2eb89944fb4f7d53de">
  <div class="header-wrapper">
    <a href="https://onthedock.github.io/post/171118-gogs-no-arranca-en-rpi/" class="thumbnail" title="Gogs No Arranca en la Raspberry Pi después de la configuración inicial"></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="https://onthedock.github.io/post/171118-gogs-no-arranca-en-rpi/">Gogs No Arranca en la Raspberry Pi después de la configuración inicial</a></h2>
        <ul class="p-facts">
          <li><time datetime="2017-11-18T22:34:59JST">18 Nov 2017</time></li>
          <li><a href="https://onthedock.github.io/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li><li><article class="li sm article-70a1a0028c7c78526f004c0e3218a2b3">
  <div class="header-wrapper">
    <a href="https://onthedock.github.io/post/171111-snc-en-rpi3/" class="thumbnail" title="Single node cluster en la RPi3"></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="https://onthedock.github.io/post/171111-snc-en-rpi3/">Single node cluster en la RPi3</a></h2>
        <ul class="p-facts">
          <li><time datetime="2017-11-11T12:08:36JST">11 Nov 2017</time></li>
          <li><a href="https://onthedock.github.io/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li><li><article class="li sm article-f81b2bb759a18deaa3b5575087686fe7">
  <div class="header-wrapper">
    <a href="https://onthedock.github.io/post/171106-gogs-como-crear-tu-propio-servicio-de-hospedaje-de-repos-git/" class="thumbnail" title="Gogs - Cómo crear tu propio servicio de hospedaje de repositorios Git"></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="https://onthedock.github.io/post/171106-gogs-como-crear-tu-propio-servicio-de-hospedaje-de-repos-git/">Gogs - Cómo crear tu propio servicio de hospedaje de repositorios Git</a></h2>
        <ul class="p-facts">
          <li><time datetime="2017-11-06T22:11:26JST">6 Nov 2017</time></li>
          <li><a href="https://onthedock.github.io/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li><li><article class="li sm article-156dcec052e59d7d9f0de2250fda46f4">
  <div class="header-wrapper">
    <a href="https://onthedock.github.io/post/171105-dokuwiki-uso-de-cpu-en-rpi/" class="thumbnail" title="Dokuwiki en Docker - Uso de CPU en Raspberry Pi"></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="https://onthedock.github.io/post/171105-dokuwiki-uso-de-cpu-en-rpi/">Dokuwiki en Docker - Uso de CPU en Raspberry Pi</a></h2>
        <ul class="p-facts">
          <li><time datetime="2017-11-05T12:22:00JST">5 Nov 2017</time></li>
          <li><a href="https://onthedock.github.io/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li>
    </ul>
  </section>
  
</div>


    </main>

    

    <footer class="l-footer">
      <div class="l-container">
        <p class="copyright-notice">Handmade with &#9829; by Xavi Aznar</p>
        <aside>
          <p class="attribution">Powered by <a href="https://gohugo.io/">Hugo</a> using <a href="https://github.com/dim0627/hugo_theme_aglaus" class="h-logo">Aglaus</a> (designed by <a href="http://yet.unresolved.xyz/">Daisuke Tsuji</a>).</p>
        </aside>
      </div>
    </footer>

    <a href="#" class="p-movetop" title="ページ上部へ戻る" rel="nofollow"></a>
  </body>
</html>

