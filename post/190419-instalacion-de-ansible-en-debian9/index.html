<!DOCTYPE html>
<html ⚡>
  <head>
    <meta charset="utf-8">
<meta name="pinterest" content="nopin">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name="theme-color" content="#263238">

<meta name="generator" content="Hugo 0.79.0" />

<link rel="apple-touch-icon" href="https://onthedock.github.io/images/logo.png">


<link rel="canonical" href="https://onthedock.github.io/post/190419-instalacion-de-ansible-en-debian9/">


    
    <link href="https://fonts.googleapis.com/css?family=Lobster|Lato:400,700" rel="stylesheet">
    
    <title>Instalación de Ansible en Debian 9 - On The Dock</title>
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    
    <script async custom-element="amp-twitter" src="https://cdn.ampproject.org/v0/amp-twitter-0.1.js"></script>
<script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
<script async custom-element="amp-ad" src="https://cdn.ampproject.org/v0/amp-ad-0.1.js"></script>

    
<meta name="description" content="&lt;p&gt;Ansible permite automatizar la configuración de máquinas. Curiosamente, aunque he hablado de &lt;a href=&#34;https://onthedock.github.io/tags/ansible/&#34;&gt;Ansible&lt;/a&gt; en otras ocasiones, no había dedicado ninguna entrada al proceso de instalación y configuración.&lt;/p&gt;&lt;p&gt;Vamos a corregir esta situación ;)&lt;/p&gt;">

<meta property="og:title" content="Instalación de Ansible en Debian 9 - On The Dock">
<meta property="og:type" content="article">
<meta property="og:url" content="https://onthedock.github.io/post/190419-instalacion-de-ansible-en-debian9/">
<meta property="og:image" content="https://onthedock.github.io/images/ansible.png">
<meta property="og:site_name" content="On The Dock">
<meta property="og:description" content="&lt;p&gt;Ansible permite automatizar la configuración de máquinas. Curiosamente, aunque he hablado de &lt;a href=&#34;https://onthedock.github.io/tags/ansible/&#34;&gt;Ansible&lt;/a&gt; en otras ocasiones, no había dedicado ninguna entrada al proceso de instalación y configuración.&lt;/p&gt;&lt;p&gt;Vamos a corregir esta situación ;)&lt;/p&gt;">
<meta property="og:locale" content="ja_JP">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="On The Dock">
<meta name="twitter:url" content="https://onthedock.github.io/post/190419-instalacion-de-ansible-en-debian9/">
<meta name="twitter:title" content="Instalación de Ansible en Debian 9 - On The Dock">
<meta name="twitter:description" content="&lt;p&gt;Ansible permite automatizar la configuración de máquinas. Curiosamente, aunque he hablado de &lt;a href=&#34;https://onthedock.github.io/tags/ansible/&#34;&gt;Ansible&lt;/a&gt; en otras ocasiones, no había dedicado ninguna entrada al proceso de instalación y configuración.&lt;/p&gt;&lt;p&gt;Vamos a corregir esta situación ;)&lt;/p&gt;">
<meta name="twitter:image" content="https://onthedock.github.io/images/ansible.png">


<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "NewsArticle",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id":"https:\/\/onthedock.github.io\/"
    },
    "headline": "Instalación de Ansible en Debian 9 - On The Dock",
    "image": {
      "@type": "ImageObject",
      "url": "https:\/\/onthedock.github.io\/images\/ansible.png",
      "height": 800,
      "width": 800
    },
    "datePublished": "2019-04-19T17:04:12JST",
    "dateModified": "2019-04-19T17:04:12JST",
    "author": {
      "@type": "Person",
      "name": "On The Dock"
    },
    "publisher": {
      "@type": "Organization",
      "name": "On The Dock",
      "logo": {
        "@type": "ImageObject",
        "url": "https:\/\/onthedock.github.io\/images/logo.png",
        "width": 600,
        "height": 60
      }
    },
    "description": "\u003cp\u003eAnsible permite automatizar la configuración de máquinas. Curiosamente, aunque he hablado de \u003ca href=\u0022https:\/\/onthedock.github.io\/tags\/ansible\/\u0022\u003eAnsible\u003c\/a\u003e en otras ocasiones, no había dedicado ninguna entrada al proceso de instalación y configuración.\u003c\/p\u003e\n\u003cp\u003eVamos a corregir esta situación ;)\u003c\/p\u003e"
  }
</script>


    <style amp-custom>
      html { font-size: 18px;}@media (max-width: 768px) { html { font-size: 15px; }}body { font-family: Lato,'Hiragino Kaku Gothic Pro',メイリオ,Meiryo,sans-serif; font-size: inherit; margin: 0; color: #263238;}html, body { margin: 0;}a { text-decoration: none; color: #e91e63;}p { margin: 0;}ul,ol { margin: 0; padding: 0;}h1, h2, h3, h4, h5, h6 { margin: 0; font-weight: 700;}h1 { font-size: 1.8rem; line-height: 2rem; margin: 1.5rem 0; }h2 { font-size: 1.4rem; line-height: 2rem; margin: 1.5rem 0; }h3 { font-size: 1.2rem; line-height: 1.5rem; margin: 1.5rem 0; }h4, h5, h6 { font-size: 1rem; line-height: 1.5rem; margin: 1.5rem 0; }.clearfix::after { content: ''; display: block; clear: both;}main{ display: block;}.searchbar{ display: block; border: none; margin: 1em auto; max-width: 780px; text-align: center;}/* Layouts */.l-header { padding: .5rem 0; margin-bottom: 2rem; border-bottom: 1px dashed #cfd8dc; text-align: center;}.l-footer { font-size: .8rem; padding: 1rem 0; border-top: 1px dashed #cfd8dc;}.l-footer .copyright-notice,.l-footer .attribution { text-align: center;}.l-container { max-width: 42rem; margin: 0 auto; padding: 0 1rem;}/* Parts:logo */.p-logo { font-family: Lobster, cursive;}.p-logo a { color: #000; font-size: 1.6rem; line-height: 2rem;}/* Parts:section */section { border-top: 2px solid #eceff1; padding: 1.5rem 0;}section>header { text-transform: uppercase; font-weight: 700; margin-bottom: 2rem; text-align: center;}section>header span { display: inline-block; background-color: #000; color: #fff; letter-spacing: 3px; font-size: .7rem; padding: .5rem .75rem;}/* Parts:facts */.p-facts { list-style: none; font-size: .8rem; margin-bottom: 1rem;}.p-facts:last-child { margin-bottom: 0;}.p-facts li { display: inline-block; margin-right: .5rem; text-transform: uppercase;}.p-facts li header { margin-bottom: .25rem; font-weight: 700;}.p-facts li header a { color: #000; text-decoration: underline;}.p-facts li li { display: inline-block; margin-right: .5rem;}.p-facts li li::after { content: ',';}.p-facts li li:last-child::after { content: '';}/* Parts:crumb */.p-crumb { list-style: none; margin-bottom: 1rem; font-size: .8rem; text-transform: uppercase; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.p-crumb:last-child { margin-bottom: 0;}.p-crumb li { display: inline;}.p-crumb li::after { content: '›'; margin: 0 .5rem;}.p-crumb li:last-child::after { content: '';}/* Parts:page-title */.p-page-title { margin-bottom: 2rem;}.p-page-title .title { margin-bottom: .5rem;}/* Parts:share */.p-share { margin-bottom: 1.5rem; text-align: center;}.p-share a { display: inline-block; text-align: center; padding: .5rem .5rem; margin-right: .25rem; font-size: .6rem; background-color: #eceff1; font-weight: 700;}.p-share a.ht { color: #00a4de; }.p-share a.fb { color: #3b5998; }.p-share a.tw { color: #1da1f2; }.p-share a.ln { color: #00c300; }.p-share a.ht::before { content: 'Hatena'; }.p-share a.fb::before { content: 'Facebook'; }.p-share a.tw::before { content: 'Twitter'; }.p-share a.ln::before { content: 'LINE'; }/* Parts:terms */.p-terms { padding-left: 2rem;}/* Parts:paginator */.p-paginator { text-align: center; margin-bottom: 3rem; padding-top: 2rem;}.p-paginator a { display: inline-block; border: 2px solid #eceff1; color: #263238; line-height: 2rem; padding: 0 1rem;}/* Parts:article */.p-articles { list-style: none;}.p-articles>li { margin-bottom: 1.5rem; padding-bottom: 1.5rem; border-bottom: 1px dashed #cfd8dc;}.p-articles>li:last-child { border-bottom: none; padding-bottom: 0;}.p-articles.thin>li { margin-bottom: 1rem; padding-bottom: 1rem;}article .article-header { display: table-cell; height: 6rem; vertical-align: middle;}article .title { margin: 0; margin-bottom: .5rem; font-size: 1.4rem; line-height: 2rem;}article .title a { color: #000;}article .header-wrapper { margin-bottom: 1.5rem;}article .thumbnail { display: block; background-position: center; background-size: cover; background-image: url(https://onthedock.github.io/images/default.jpg); width: 6rem; height: 6rem; border-radius: 50%; box-shadow: 0 0 3px 0 #333 inset; float: left; margin-right: 1rem;}article .summary { margin-bottom: 1.5rem;}article .readmore { text-align: center;}article .readmore a { font-size: .8rem; color: #000; text-decoration: underline;}article.li.sm .header-wrapper { margin-bottom: 0;}.article-body h2 { padding: 1rem 0; color: #55bbbb; border-bottom: 2px solid #eceff1;}.article-body h2:first-child { margin-top: 0; }.article-body h3 { color: #8997e4; font-style: italic;}.article-body h4 { border-left: solid .25rem #cddc39; padding: 0 .5rem;}.article-body p { margin: 1.5rem 0; line-height: 1.5rem;}.article-body a { text-decoration: underline;}.article-body ul,.article-body ol { padding-left: 1.5rem;}.article-body li { line-height: 2rem;}.article-body code { display: inline-block; font-family: Menlo, consolas, monospace; background-color: #eceff1; font-size: .8rem; padding: 0 .5rem; line-height: 1.5rem;}.article-body pre { margin: 1.5rem 0; padding: 1.5rem; font-size: .8rem; background-color: #eeeeef; color: #444; overflow: auto;}.article-body pre code { background-color: transparent;}.article-body blockquote { /* margin: 1.2rem 0; padding: .5rem 0; */ /*font-size: .8rem;*/ border-top: 1px solid #eceff1; border-bottom: 1px solid #eceff1; color: #607d8b;}.article-body blockquote p { margin: .5rem 0; line-height: 1.5rem;}.article-body strong { /*box-shadow: 0 -.5rem 0 0 #f06292 inset;*/ font-style: bold; font-weight: 700; /*color: #ff5722; */}.article-body em { /*font-style: normal;*/ /*font-weight: 700; color: #00c300;*/ /*color: #00c300;*/ font-style: oblique;}.article-body figure { margin: 1.5rem -2rem; }.article-body figure.left,.article-body figure.right { width: 15rem; height: 12rem; margin-top: 0; margin-left: 0; margin-right: 0;}.article-body figure.left { float: left; margin-right: 1rem; margin-left: -2rem; }.article-body figure.right { float: right; margin-left: 1rem; margin-right: -2rem; }@media (max-width: 768px) { .article-body figure { margin: 1.5rem -1rem; } .article-body figure.left, .article-body figure.right { float: none; margin: 0 -1rem; width: auto; height: auto; }}.article-body figcaption { padding: .5rem 0; font-size: .8rem; text-align: center;}.article-body figcaption a { color: #263238;}

       .article-1be861ee6a7c05ba2a5776a68120327c .thumbnail { background-image: url(https://onthedock.github.io/images/traefik.png);  }  .article-6196d298c4378d228f2ab7aeacc3b954 .thumbnail { background-image: url(https://onthedock.github.io/images/links.png);  }  .article-989c3a6a94e729ffbdf9bda5f321b198 .thumbnail { background-image: url(https://onthedock.github.io/images/roadmap.png);  }  .article-b5774c1af73ca2d2b4752dba3cca3af5 .thumbnail { background-image: url(https://onthedock.github.io/images/bug.png);  }  .article-5e7a622986ce86264ec760d50d1b24dc .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-5ebb631840a278963e57bd511343a7de .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-b81d424b8eb3bb8c288fe36d23387788 .thumbnail { background-image: url(https://onthedock.github.io/images/gitea.jpg);  }  .article-0626a0be459395ce9ead913f3f08adc4 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-fcee06d4be0563afd210fdcfb47dcff0 .thumbnail { background-image: url(https://onthedock.github.io/images/virtualbox.png);  }  .article-1db77bc78e9304df7ba062b03813a3be .thumbnail { background-image: url(https://onthedock.github.io/images/virtualbox.png);  }  .article-36c4d422ca047b8a471571c76b65d6c6 .thumbnail { background-image: url(https://onthedock.github.io/images/git.png);  }  .article-4c8c13dd5627da332e5774b27cf40099 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-6e92220fbd4bf73e9add44ea35db7875 .thumbnail { background-image: url(https://onthedock.github.io/images/cloud-init.png);  }  .article-65945fdc2f7a451d2eba88e27bcae615 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-d4ae75e268955792710fe6fdbf38a8cd .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-f875614400506b86e2eed3af9535c6f0 .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-70ddbb73f4be0ef264658d45b44a1501 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-af7ce20f88530a679b64bc11f369dd66 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-749180de0a0f927ac4118d5f742aec7a .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-eabbba2a574b52017ab09aadb1e27892 .thumbnail { background-image: url(https://onthedock.github.io/images/git.png);  }  .article-4df08a53150d4f7d2766c8debd1831a3 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-ae823e9b9f3db0ab3a477ed5e16bcb32 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-9e165e5c05a4125a00ec1ec5048a7d4c .thumbnail { background-image: url(https://onthedock.github.io/images/git.png);  }  .article-0b46f42d26003d0a8a0c0a8792e872c3 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-bf486333bdc41366eb67ebcd83df7dfd .thumbnail { background-image: url(https://onthedock.github.io/images/okd.png);  }  .article-5b04a4598c80921d43637c7023ad4877 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-6548eb3cdf7ceb97a246efd3d61b22ae .thumbnail { background-image: url(https://onthedock.github.io/images/code.jpg);  }  .article-67ffd386f3fb60aa875a1b304dcbd33c .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-fdbe83149bbb772c83e8270b925cba5f .thumbnail { background-image: url(https://onthedock.github.io/images/code.jpg);  }  .article-fa396b4de84b2dfd9b95c5edfc10cc30 .thumbnail { background-image: url(https://onthedock.github.io/images/python.png);  }  .article-296c831bcc1b030d00b8ee27e96a5226 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-b2b753da998b1936d8c475787c1de07f .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-b95004b4126fa41395385c5e37f31081 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-a8fd68175b85c6ab1e57dd164e56c25e .thumbnail { background-image: url(https://onthedock.github.io/images/MabelAmber-mini.png);  }  .article-cd0ad924309bc0e2310a28f4574f3ee6 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-c4149a0be2e1a3d215d0b9dbb1340cad .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-c04747c53dc824266e9428efb65f072d .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-c6d431118f1f3fa0e4ec3e6e454bb634 .thumbnail { background-image: url(https://onthedock.github.io/images/roadmap.png);  }  .article-1ce4351c9635f2cadcc6057dd96238d9 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-8cb097c83a6ec6e1fe01c4278c8a35c6 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-22355649e0a434b67e571674216e1e54 .thumbnail { background-image: url(https://onthedock.github.io/images/aws.png);  }  .article-23858711b322c88a48f2b2d742a36f3d .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-d92b1a0387e28368be9738f69f1aa7ce .thumbnail { background-image: url(https://onthedock.github.io/images/alpine.png);  }  .article-98124356b113c2a6917683aca3c29a99 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-a093ac0f1b7268afeade39452595d2f1 .thumbnail { background-image: url(https://onthedock.github.io/images/bug.png);  }  .article-38834ecfa3e2f37d5a70e6884d71074a .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-932932e45567c9f06aca44ce87e2a385 .thumbnail { background-image: url(https://onthedock.github.io/images/bug.png);  }  .article-c1ca90597f186bd1ad8bb1c94f4a447a .thumbnail { background-image: url(https://onthedock.github.io/images/alpine.png);  }  .article-765192a6c291e47974a12dcf8924d8db .thumbnail { background-image: url(https://onthedock.github.io/images/ansible.png);  }  .article-b764fa70c94a1d2fd4fd14237d21967d .thumbnail { background-image: url(https://onthedock.github.io/images/python.png);  }  .article-f68c36fc2fb55e32944f45e490e5e5e9 .thumbnail { background-image: url(https://onthedock.github.io/images/ansible.png);  }  .article-bd81d8ba70bc61639103fb97b7490aed .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-1c63237c8383a2e30ee2e3fcc7150643 .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-c0152a70142649803b63b10edd4921d3 .thumbnail { background-image: url(https://onthedock.github.io/images/asciidoctor.png);  }  .article-396652c83bff211b566a6a3fd5bf1913 .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-bde56cbd0283e6a7909a444b8e08e5c5 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-0c530d26aef03bb376ea14c3014c0325 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-0d445519a7825dfd55db94b8b9817031 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-a57735573e4d2b1c48a69a09a73878b7 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-ccf02aadbf150df00f9a2962c5cc2c32 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-b4fa6645c244835f679427bd29ec86fb .thumbnail { background-image: url(https://onthedock.github.io/images/190101/amazonlinux.png);  }  .article-1f90092555e2ba74f132561ef66df1d5 .thumbnail { background-image: url(https://onthedock.github.io/images/ansible.png);  }  .article-702ecd15d93c0a640329570a1515ec22 .thumbnail { background-image: url(https://onthedock.github.io/images/181124/roadmap.png);  }  .article-fe261e0b7d326a141c1ff662c1caf421 .thumbnail { background-image: url(https://onthedock.github.io/images/cloud-init.png);  }  .article-2fc7b42f0ad38b1d0c3bda16184154ed .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-9a5a658f072f34635bd665eae7d0d498 .thumbnail { background-image: url(https://onthedock.github.io/images/docker-compose.jpg);  }  .article-f8770956a383aeb68930a558bae85310 .thumbnail { background-image: url(https://onthedock.github.io/images/automation.png);  }  .article-d27d7b7a4057230acbe88420832d3a67 .thumbnail { background-image: url(https://onthedock.github.io/images/gitea.jpg);  }  .article-365473b8c27877be27245e38a5feb95c .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-8da35239d2403351cd1910b3939787f6 .thumbnail { background-image: url(https://onthedock.github.io/images/jenkins.png);  }  .article-4f389af4c69dce1f727b95af66218cc0 .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-b63b63041915fd06eb96d2d6b298ac9b .thumbnail { background-image: url(https://onthedock.github.io/images/sonarqube.png);  }  .article-db94723578a25efdcd1489b628ae77c9 .thumbnail { background-image: url(https://onthedock.github.io/images/sonarqube.png);  }  .article-92e6838a86f3c412b36d6abbbb0f3f77 .thumbnail { background-image: url(https://onthedock.github.io/images/jenkins.png);  }  .article-8fd0d0535b25566772d8bfcab456999e .thumbnail { background-image: url(https://onthedock.github.io/images/gogs.png);  }  .article-9d852d24f77755909ea56d2ce72cb408 .thumbnail { background-image: url(https://onthedock.github.io/images/jenkins.png);  }  .article-015f92caa0da0be71b6008713be0e15f .thumbnail { background-image: url(https://onthedock.github.io/images/gogs.png);  }  .article-b40404c5768e20c9cf4a0ef9b40d5d8c .thumbnail { background-image: url(https://onthedock.github.io/images/jenkins.png);  }  .article-56679bf127fa712be78799b59e8ebcbe .thumbnail { background-image: url(https://onthedock.github.io/images/jenkins.png);  }  .article-c926846ccb5ddda2e607d41a7eed1e7e .thumbnail { background-image: url(https://onthedock.github.io/images/jenkins.png);  }  .article-439d0c4b480f76cd3e4e59c497020808 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-ca9a82a3e9074b202ea71b79b8f06d72 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-5dd2fbecd3c1861b16d6ccbae8458692 .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-d27ecb2023ff85d0423abc98d4d8ded4 .thumbnail { background-image: url(https://onthedock.github.io/images/portainer.png);  }  .article-82fdfab1e200b6fc1a28801ee717993c .thumbnail { background-image: url(https://onthedock.github.io/images/jenkins.png);  }  .article-ff3cf8144aa52ea6d7195126da8ce676 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-88a2b37925efc71e7f9ec017570e19f0 .thumbnail { background-image: url(https://onthedock.github.io/images/vagrant.png);  }  .article-f22b7fd29e14db2fbd6cd579c2a0d5c9 .thumbnail { background-image: url(https://onthedock.github.io/images/vagrant.png);  }  .article-fc9c9a2b1dcd0c5683f7adbafda8f7c8 .thumbnail { background-image: url(https://onthedock.github.io/images/vagrant.png);  }  .article-a45fe2c1cdbadc45cbf34a63ab37ebcc .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-9e27e7f162c2feae804cbc006c1c9349 .thumbnail { background-image: url(https://onthedock.github.io/images/MabelAmber-mini.png);  }  .article-2a7b6b0759e163accb88c9261e4c0bbf .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-340e5d68f76888b0b8debb38ef25d46b .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-2fc73bdfb18aaf2eb89944fb4f7d53de .thumbnail { background-image: url(https://onthedock.github.io/images/gogs.png);  }  .article-70a1a0028c7c78526f004c0e3218a2b3 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-f81b2bb759a18deaa3b5575087686fe7 .thumbnail { background-image: url(https://onthedock.github.io/images/gogs.png);  }  .article-156dcec052e59d7d9f0de2250fda46f4 .thumbnail { background-image: url(https://onthedock.github.io/images/dokuwiki-on-docker.png);  }  .article-f831baebaad56b8e3d70750749393da3 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-df14f92fc6edab1c8632e66ef7c7e5a6 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-516ab75e14eb7886aaab03ff75dbfc6b .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-d1ead2ec3d26cb7f91ef8234915eb13f .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-0b9c6f0820f2306f6cc2bfd170dccb8e .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-1cbc9cfd0ad3798b23d19eac020b3153 .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-a32274b07ce43fef61c7f19e4b68f650 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-9b0b3a180af20b5c091134d23cb6d383 .thumbnail { background-image: url(https://onthedock.github.io/images/minio.jpg);  }  .article-b20735633157cb1e57eb0c1d05406149 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-d1e335a06f765bffda53d2e123044b27 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-c36c64b9d6ce0d2c95381976831c3160 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-ee7d8acecc9de179b9d1cecb3d253215 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-2480be47fe45cfc13b07c86c32ed8cda .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-99a6578fdc273f40a61d182bcb5917c4 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-3ffff09a2dd1f953bbb8624d88756829 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-0a9cef5c4637bd946188e37439fef69c .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-42a206d287914317761f7749b964ddb2 .thumbnail { background-image: url(https://onthedock.github.io/images/alpine.png);  }  .article-85dee6c250520e561ebc93740f1d514f .thumbnail { background-image: url(https://onthedock.github.io/images/alpine.png);  }  .article-a65000ba68f97000bb927be3f88f75bd .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-2de6ff3b0144ea18b2ef056107448a33 .thumbnail { background-image: url(https://onthedock.github.io/images/yaml.png);  }  .article-a8aea2191f0d8d238ab6217feba51ac3 .thumbnail { background-image: url(https://onthedock.github.io/images/vagrant.png);  }  .article-67cd76b76e108b6604b344e92a3c329a .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-d341a5f8cd54b9da7a3a6d1168365c25 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-59e1fe22eaedce05afe517780f87cc98 .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-87ee3835fe3b255e8566c3bfed2bd38b .thumbnail { background-image: url(https://onthedock.github.io/images/portainer.png);  }  .article-086bb6242700303c8a958c5e74df0ca9 .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-4c6b9124141ca1a8135b9177248b7e15 .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-911698c11286b3ef9eb1a11440c09845 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-6a0861472d6f0696079c81e3710d5fe8 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-40b8655184d8e4a2ca3650aece49e845 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-857a5f627557e7d92f1386f7c6e04dee .thumbnail { background-image: url(https://onthedock.github.io/images/raspberry_pi.png);  }  .article-4db85da082f771e8fb9029adad4173ec .thumbnail { background-image: url(https://onthedock.github.io/images/raspberry_pi.png);  }  .article-b69159ccecf58bff548bbd08481b6e15 .thumbnail { background-image: url(https://onthedock.github.io/images/raspberry_pi.png);  }  .article-da222607e970c37b0b59d8011a2e3398 .thumbnail { background-image: url(https://onthedock.github.io/images/portainer.png);  }  .article-7b36708a64c36890ceb1bf481f3de1fa .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-d68e08dcca5eafff4ae0d8d06280bf02 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-8ff87e4d24c357bbee842dd088ef4cde .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-d0ca4b0abe6c0c6d22baa800e3fc9935 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-63c13529eb1936073e0adc09d7e35b59 .thumbnail { background-image: url(https://onthedock.github.io/images/kubernetes.png);  }  .article-2e821bde62a219fe0b94f62e989269e7 .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-df564c824db9099fd85c925ad9635cda .thumbnail { background-image: url(https://onthedock.github.io/images/raspberry_pi.png);  }  .article-203d2d443889d9d70ca2ad9abcca49aa .thumbnail { background-image: url(https://onthedock.github.io/images/docker.png);  }  .article-526bade0815ac377e81216604b97c5f7 .thumbnail { background-image: url(https://onthedock.github.io/images/github.png);  }  .article-3d9c586728a0009cb0621b0368120462 .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-160ee3ec04bb73e590f125b42640b34b .thumbnail { background-image: url(https://onthedock.github.io/images/hugo.png);  }  .article-c862ac2fb3511b386b4247a80aa6b90b .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-8a50a2d4216b1a3b2b46c646bd24c5e9 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-f027d2889032f918da8e3cc9c03169e0 .thumbnail { background-image: url(https://onthedock.github.io/images/linux.png);  }  .article-6db4ecfe853552466ce5a71b1221a2a0 .thumbnail { background-image: url(https://onthedock.github.io/images/hypriot.png);  } 
    </style>
  </head>

  <body>
    
    
    

    <header class="l-header">
      <div class="l-container">
        <div class="h-logo p-logo">
          <a href="https://onthedock.github.io/" class="h-logo">On The Dock</a>
          <p class="h-logo">Un blog sobre el Cloud, Kubernetes, DevOps, Docker y Raspberry Pi por Xavier Aznar</p>
        </div>
      </div>
    </header>

    <main>
      
<div class="l-container">
  <article class="single article-f68c36fc2fb55e32944f45e490e5e5e9">
  <div class="header-wrapper">
    <a href="https://onthedock.github.io/post/190419-instalacion-de-ansible-en-debian9/" class="thumbnail" title="Instalación de Ansible en Debian 9"></a>
    <header class="article-header">
      <div class="clearfix">
        <h1 class="title">Instalación de Ansible en Debian 9</h1>
        <ul class="p-facts">
          <li><time datetime="2019-04-19T17:04:12JST">19 Apr 2019</time></li>
          <li><a href="https://onthedock.github.io/post/">post</a></li>
          
          <li>Xavier Aznar</li>
        </ul>
      </div>
    </header>
  </div>

  <div class="article-body"><p>Ansible permite automatizar la configuración de máquinas. Curiosamente, aunque he hablado de <a href="https://onthedock.github.io/tags/ansible/">Ansible</a> en otras ocasiones, no había dedicado ninguna entrada al proceso de instalación y configuración.</p>
<p>Vamos a corregir esta situación ;)</p>
<h1 id="instalación-de-ansible">Instalación de Ansible</h1>
<p>Para instalar Ansible en Debian, seguimos los pasos indicados en la documentación oficial <a href="https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html#latest-releases-via-apt-debian">Installation Guide</a>.</p>
<p>En primer lugar, añadimos el repositorio de Ubuntu. En mi caso, prefiero añadir el repositorio en un fichero separado, en <code>/etc/apt/sources.list.d/</code> en vez de hacerlo directamente en <code>/etc/apt/sources.list</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nano /etc/apt/sources.list.d/ubuntu-trusty.list
</code></pre></div><p>Añade la línea <code>deb http://ppa.launchpad.net/ansible/ansible/ubuntu trusty main</code> y guarda los cambios.</p>
<p>Antes de lanzar <code>apt update</code> e instalar Ansible, debemos incorporar la clave del repositorio a nuestro sistema:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 93C4A3FD7BB9C367
sudo apt-get update
sudo apt-get install ansible
</code></pre></div><p>En mi caso, no es posible recuperar la clave:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 93C4A3FD7BB9C367
Executing: /tmp/apt-key-gpghome.mI9WEO81of/gpg.1.sh --keyserver keyserver.ubuntu.com --recv-keys 93C4A3FD7BB9C367
gpg: failed to start the dirmngr <span style="color:#e6db74">&#39;/usr/bin/dirmngr&#39;</span>: No such file or directory
gpg: connecting dirmngr at <span style="color:#e6db74">&#39;/tmp/apt-key-gpghome.mI9WEO81of/S.dirmngr&#39;</span> failed: No such file or directory
gpg: keyserver receive failed: No dirmngr
</code></pre></div><p>La solución pasa por instalar primero <code>dirmngr</code> usando <code>sudo apt install dirmngr</code>.</p>
<p>Una vez solucionado, recuperamos la clave pública del repositorio:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 93C4A3FD7BB9C367
Executing: /tmp/apt-key-gpghome.kkjSRhUytC/gpg.1.sh --keyserver keyserver.ubuntu.com --recv-keys 93C4A3FD7BB9C367
gpg: key 93C4A3FD7BB9C367: public key <span style="color:#e6db74">&#34;Launchpad PPA for Ansible, Inc.&#34;</span> imported
gpg: Total number processed: <span style="color:#ae81ff">1</span>
gpg:               imported: <span style="color:#ae81ff">1</span>
</code></pre></div><p>Ahora sí, <code>update</code> e <code>install</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo apt update
sudo apt install ansible
</code></pre></div><p>Validamos que Ansible está instalado mediante:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ansible --version
ansible 2.7.10
  config file <span style="color:#f92672">=</span> /etc/ansible/ansible.cfg
  configured module search path <span style="color:#f92672">=</span> <span style="color:#f92672">[</span>u<span style="color:#e6db74">&#39;/home/operador/.ansible/plugins/modules&#39;</span>, u<span style="color:#e6db74">&#39;/usr/share/ansible/plugins/modules&#39;</span><span style="color:#f92672">]</span>
  ansible python module location <span style="color:#f92672">=</span> /usr/lib/python2.7/dist-packages/ansible
  executable location <span style="color:#f92672">=</span> /usr/bin/ansible
  python version <span style="color:#f92672">=</span> 2.7.13 <span style="color:#f92672">(</span>default, Sep <span style="color:#ae81ff">26</span> 2018, 18:42:22<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>GCC 6.3.0 20170516<span style="color:#f92672">]</span>
</code></pre></div><h2 id="usuario-de-gestión-para-ansible">Usuario de gestión para Ansible</h2>
<p>Vamos a generar un usuario específico para Ansible, que se autenticará en las máquinas gestionadas usando un par de claves SSH.</p>
<p>Para crear el usuario, usamos el comando <code>adduser</code>:</p>
<blockquote>
<p>Si usas el comando <code>useradd</code>, sólo se crea el usuario (no se crea la carpeta <code>$home</code>, no se establece una contraseña para el usuario, etc).</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ sudo adduser ansible-service-account
Adding user <span style="color:#e6db74">`</span>ansible-service-account<span style="color:#e6db74">&#39; ...
</span><span style="color:#e6db74">Adding new group `ansible-service-account&#39;</span> <span style="color:#f92672">(</span>1001<span style="color:#f92672">)</span> ...
Adding new user <span style="color:#e6db74">`</span>ansible-service-account<span style="color:#e6db74">&#39; (1001) with group `ansible-service-account&#39;</span> ...
Creating home directory <span style="color:#e6db74">`</span>/home/ansible-service-account<span style="color:#e6db74">&#39; ...
</span><span style="color:#e6db74">Copying files from `/etc/skel&#39;</span> ...
Enter new UNIX password:
Retype new UNIX password:
passwd: password updated successfully
Changing the user information <span style="color:#66d9ef">for</span> ansible-service-account
Enter the new value, or press ENTER <span style="color:#66d9ef">for</span> the default
   Full Name <span style="color:#f92672">[]</span>: Ansible Service Account
   Room Number <span style="color:#f92672">[]</span>:
   Work Phone <span style="color:#f92672">[]</span>:
   Home Phone <span style="color:#f92672">[]</span>:
   Other <span style="color:#f92672">[]</span>:
Is the information correct? <span style="color:#f92672">[</span>Y/n<span style="color:#f92672">]</span> y
$
</code></pre></div><p>Usando <code>sudo su ansible-service-account</code> cambiamos de identidad y nos convertimos en el usuario especificado.</p>
<h2 id="generar-la-clave-ssh">Generar la clave SSH</h2>
<p>En este artículo de 2016, <a href="https://blog.g3rt.nl/upgrade-your-ssh-keys.html">Upgrade your SSH keys!</a> se recomienda evitar las claves RSA &lt; 2048 bits, usando en vez de ello el nuevo algoritmo ed25519.</p>
<p>Siguiendo esta recomendación, generamos las claves SSH para el usuario recién creado.
Esta cuenta se usará para realizar acciones automatizadas, por lo que no especificaremos una <em>passphrase</em>:</p>
<blockquote>
<p>Usamos la opción <code>-C</code> para añadir un comentario que permita identificar fácilmente el par de claves generado.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ssh-keygen -o -a <span style="color:#ae81ff">100</span> -t ed25519 -C ansible-service-account
Generating public/private ed25519 key pair.
Enter file in which to save the key <span style="color:#f92672">(</span>/home/ansible-service-account/.ssh/id_ed25519<span style="color:#f92672">)</span>:
Created directory <span style="color:#e6db74">&#39;/home/ansible-service-account/.ssh&#39;</span>.
Enter passphrase <span style="color:#f92672">(</span>empty <span style="color:#66d9ef">for</span> no passphrase<span style="color:#f92672">)</span>:
Enter same passphrase again:
Your identification has been saved in /home/ansible-service-account/.ssh/id_ed25519.
Your public key has been saved in /home/ansible-service-account/.ssh/id_ed25519.pub.
The key fingerprint is:
SHA256:4Zp/sQr0n3wvwMkQaUt3aqnGvnfIWdicuYEFCW7WFes ansible-service-account
The key<span style="color:#960050;background-color:#1e0010">&#39;</span>s randomart image is:
+--<span style="color:#f92672">[</span>ED25519 256<span style="color:#f92672">]</span>--+
|        .o .o.   |
|       .<span style="color:#f92672">=</span>.+...   |
|       o<span style="color:#f92672">=</span>+.<span style="color:#f92672">=</span>.    |
|       +o.+..    |
|      ..S* BEo   |
|     . ++ O B    |
|      +o.. B o   |
|       o.oB.<span style="color:#f92672">=</span>    |
|        +<span style="color:#f92672">=</span>+o o.  |
+----<span style="color:#f92672">[</span>SHA256<span style="color:#f92672">]</span>-----+
</code></pre></div><p>En la carpeta <code>.ssh</code> recién creada se encuentran el par de claves SSH, tanto la privada (que debes mantener privada) como la pública.</p>
<p>Puedes verificarlo mediante:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ls ~/.ssh/
id_ed25519  id_ed25519.pub
</code></pre></div><p>La parte pública de la clave únicamente <em>encaja</em> con la parte privada (que sólo tiene el usuario <em>ansible-service-account</em>), por lo que el siguiente paso es copiar esta clave pública en los máquinas gestionadas por Ansible.</p>
<p>El usuario <em>ansible-service-account</em> realizará tareas de administración, por lo que debemos proporcionar la capacidad de elevar permisos en las máquinas gestionadas.</p>
<h2 id="tareas-de-configuración">Tareas de configuración</h2>
<p>En vez de realizar las mismas acciones una y otra vez, usaremos un <em>script</em> para automatizar estas tareas.
Este script se encuentra en GitHub <a href="https://github.com/onthedock/vmconfig4ansible">onthedock/vmconfig4ansible
</a>.</p>
<blockquote>
<p>Puedes incluir estas configuraciones en tu <em>imagen base</em> o ejecutarlas durante el primer arranque de la máquina si usas <a href="https://cloudinit.readthedocs.io/en/latest/">cloud-init</a>, por ejemplo.</p>
</blockquote>
<h3 id="crear-el-usuario-de-gestión-en-la-máquina-gestionada">Crear el usuario de gestión en la máquina gestionada</h3>
<p>Creamos el usuario local en la máquina gestionada mediante <code>useradd</code>; esto no crea la carpeta <code>$home</code> del usuario, ni establece grupos o una contraseña para el usuario.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Create ansible user</span>
echo <span style="color:#e6db74">&#34;Adding user </span>$ANSIBLE_USER<span style="color:#e6db74"> ...&#34;</span>
sudo useradd $ANSIBLE_USER
</code></pre></div><h3 id="crear-la-carpeta-homeansible_user-manualmente">Crear la carpeta <code>$home/$ANSIBLE_USER</code> manualmente</h3>
<p>El sistema remoto buscará si la parte pública de la clave presentada al conectar por SSH se encuentra en el fichero <code>$home/.ssh/authorized_keys</code>.
Como el comando <code>useradd</code> no ha creado la carpeta <code>$home</code>, la creamos manualmente:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Create .ssh folder</span>
echo <span style="color:#e6db74">&#34;Configuring user </span>$ANSIBLE_USER<span style="color:#e6db74"> authorized_keys&#34;</span>
sudo mkdir -p /home/$ANSIBLE_USER/.ssh
<span style="color:#75715e"># Copy PUBKEY to authorized_keys for $ANSIBLE_USER</span>
echo $PUBKEY &gt;&gt; authorized_keys
sudo mv authorized_keys /home/$ANSIBLE_USER/.ssh/authorized_keys
sudo chown $ANSIBLE_USER:$ANSIBLE_USER -R /home/$ANSIBLE_USER/
sudo chmod <span style="color:#ae81ff">600</span> /home/$ANSIBLE_USER/.ssh/authorized_keys
</code></pre></div><blockquote>
<p>Si tienes problemas para conectar, revisa que tanto la autenticación con clave pública como los permisos sobre <code>~/.ssh</code> y <code>~/.ssh/*</code> sean los correctos (Referencia: <a href="https://serverfault.com/a/55458">Can&rsquo;t get SSH public key authentication to work [closed]</a>)</p>
</blockquote>
<h3 id="añadir-la-clave-pública-al-fichero-authorized_keys">Añadir la clave pública al fichero <code>authorized_keys</code></h3>
<p>Una vez creada la carpeta, añadimos la clave pública al fichero. Podemos convertirnos en el usuario <code>ansible-service-account</code> y generar el fichero <code>authorized_keys</code> o, como hacemos en el script, ejecutar las tareas elevando privilegios (o directamente como <code>root</code>).
En cualquier caso, SSH requiere que únicamente el usuario <code>ansible-service-account</code> tenga acceso al fichero, por lo que arreglamos los permisos tanto de la carpeta <code>$home/ansible-service-account</code> como del fichero <code>authorized_keys</code>.</p>
<h3 id="elevación-de-permisos-sin-contraseña">Elevación de permisos sin contraseña</h3>
<p>Para que el usuario <code>ansible-service-account</code> pueda realizar tareas administrativas en las máquinas gestionadas en las que se conecta, es necesario que tenga capacidad para elevar privilegios y ejecutar tareas como <code>root</code>.</p>
<p>Podemos hacer que el <em>script</em> solicite la contraseña cuando tenga que <em>elevar</em> permisos, pero va en contra de la idea de &ldquo;automatizar&rdquo;, por lo que configuramos el usuario usado por Ansible para que pueda convertirse en <code>root</code> sin contraseña.</p>
<p>Hay varias formas de hacer que un usuario pueda elevarse sus privilegios usando <code>sudo</code>; la manera más sencilla es incluir el usuario en el grupo <code>sudo</code> (o <code>admin</code>, en algunas distribuciones), pero creo que es más adecuado añadir el usuario al fichero de <em>sudoers</em>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Passwordless sudo</span>
echo <span style="color:#e6db74">&#34;Configuring passwordless sudo...&#34;</span>
echo <span style="color:#e6db74">&#34;</span>$ANSIBLE_USER<span style="color:#e6db74"> ALL=NOPASSWD: ALL&#34;</span> &gt;&gt; $ANSIBLE_USER
<span style="color:#75715e"># Fix permissions</span>
sudo chown root:root $ANSIBLE_USER
sudo mv $ANSIBLE_USER /etc/sudoers.d/
</code></pre></div><p>Creamos un fichero con el nombre del usuario usado por Ansible y lo colocamos en <code>/etc/sudoers.d/</code>, de manera que <code>sudo</code> lo leerá como si formara parte del fichero <code>/etc/sudoers</code>, pero así mantenemos el fichero original sin modificaciones.</p>
<p>A través del fichero <em>sudoers</em> podemos restringir qué comandos puede ejecutar el usuario (y en qué máquinas), cosa que no podemos hacer si agregamos el usuario al grupo <code>sudo</code>.
Puedes obtener más información sobre cómo configurar <code>sudo</code> de forma que el usuario de Ansible sólo pueda ejecutar las tareas que tenga que ejecutar y no otras en la página <a href="https://www.sudo.ws/man/1.8.2/sudoers.man.html">Sudoers Manual</a>.</p>
<h3 id="configuración-de-python">Configuración de Python</h3>
<p>Para poder ejecutar los <em>playbooks</em> de Ansible, el único requerimiento sobre la máquina gestionada es que tenga instalado Python 2.7 o superior.</p>
<p>En Debian 9, por ejemplo, está instalado tanto Python 2.7 como Python 3.5, por lo que el Python que se usa lo determina el enlace desde <code>/usr/bin/python</code>.</p>
<p>Instalamos la última versión de Python 3 y cambiamos el enlace para que el sistema use la versión recién instalada:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Always install Python 3</span>
sudo apt install python3 -y
<span style="color:#75715e"># Update Python location</span>
sudo ln -sf /usr/bin/python3 /usr/bin/python
</code></pre></div><h2 id="test-de-ansible">Test de Ansible</h2>
<p>Después de instalar Ansible tanto en la máquina de control como en las máquinas gestionadas, es hora de validar que todo funciona.</p>
<p>Crea o edita el fichero <code>/etc/ansible/hosts</code> siguiendo las instrucciones de <a href="https://docs.ansible.com/ansible/latest/user_guide/intro_getting_started.html#your-first-commands">Your first commands</a> e incluye la IP o el nombre de la(s) máquina(s) gestionada(s).</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo nano /etc/ansible/hosts
</code></pre></div><p>A continuación, cambia al usuario configurado para Ansible y ejecuta el módulo <em>ping</em> sobre todas (<em>all</em>) las máquinas configuradas en el inventorio (el fichero <code>/etc/ansible/hosts</code>):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">operador@ansible:~$ sudo su ansible-service-account
ansible-service-account@ansible:~$ ansible all -m ping
192.168.1.215 | SUCCESS <span style="color:#f92672">=</span>&gt; <span style="color:#f92672">{</span>
    <span style="color:#e6db74">&#34;changed&#34;</span>: false,
    <span style="color:#e6db74">&#34;ping&#34;</span>: <span style="color:#e6db74">&#34;pong&#34;</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>Como puedes ver, Ansible se ha conectado al equipo remoto con IP 192.168.1.215, donde ha ejecutado el módulo <em>ping</em>, que ha devuelto <em>pong</em>, indicando que todo ha funcionado correctamente.</p>
<h2 id="resumen">Resumen</h2>
<p>La instalación de Ansible es tan sencilla como <code>apt install ansible</code>; en cuanto a configuración, para evitar permitir la conexión remota del usuario <code>root</code>, creamos un usuario específico que pueda acceder a las máquinas gestionadas usando claves SSH.</p>
<p>La configuración de las máquinas remotas puede incluirse en la <em>imagen base</em> de tus máquinas virtuales o bien pueden incluirse en el <code>user-data</code> si usas <em>cloud-init</em> (o algún proveedor de <em>cloud</em>).
En el peor de los casos, puedes automatizar las tareas en un <em>script</em> de configuración de la máquina gestionada y lanzarlo manualmente.</p>
<p>Tras esta configuración inicial de Ansible (y de las máquinas gestionadas), Ansible puede lanzar prácticamente cualquier tarea que sea necesario ejecutar sobre cualquiera de ellas, de forma individual sobre alguno de los grupos definidos en el inventorio.</p>
<p>Puedes encontrar infinidad de <em>playbooks</em> de Ansible para automatizar cualquier cosa imaginable en <a href="https://galaxy.ansible.com/">Ansible Galaxy</a>.</p></div>

  <aside class="p-share">
  <a href="http://twitter.com/intent/tweet?url=https%3a%2f%2fonthedock.github.io%2fpost%2f190419-instalacion-de-ansible-en-debian9%2f&text=Instalaci%c3%b3n%20de%20Ansible%20en%20Debian%209&tw_p=tweetbutton" title="Twitterでシェア" class="tw" target="_blank" rel="nofollow"></a>
  <a href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fonthedock.github.io%2fpost%2f190419-instalacion-de-ansible-en-debian9%2f&t=Instalaci%c3%b3n%20de%20Ansible%20en%20Debian%209" title="Facebookでシェア" class="fb" target="_blank" rel="nofollow"></a>
  <a href="http://line.me/R/msg/text/?Instalaci%c3%b3n%20de%20Ansible%20en%20Debian%209 https%3a%2f%2fonthedock.github.io%2fpost%2f190419-instalacion-de-ansible-en-debian9%2f" title="LINEでシェア" class="ln" target="_blank" rel="nofollow"></a>
  <a href="http://b.hatena.ne.jp/add?mode=confirm&url=https%3a%2f%2fonthedock.github.io%2fpost%2f190419-instalacion-de-ansible-en-debian9%2f&title=Instalaci%c3%b3n%20de%20Ansible%20en%20Debian%209" title="はてなブックマーク" class="ht" target="_blank" rel="nofollow"></a>
  <div class="searchbar">
      <iframe src="https://duckduckgo.com/search.html?site=https://onthedock.github.io/&prefill=Busca en este sitio usando DuckDuckGo" style="width: 25em;height: 48px" frameborder="0"></iframe>
    </div>
</aside>


  <footer class="article-footer">
    <section>
      <ol class="p-crumb">
        <li><a href="https://onthedock.github.io/">On The Dock</a></li>
        
        <li itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb"><a href="https://onthedock.github.io/post/" itemprop="url"><span itemprop="title">post</span></a></li>
        
        <li>Instalación de Ansible en Debian 9</li>
      </ol>

      
      
      
      <ul class="p-facts">
        <li>
          <header><a href="https://onthedock.github.io/categories/">categories</a></header>
          <ul>
            
            <li><a href="https://onthedock.github.io/categories/ops/">ops</a></li>
            
          </ul>
        </li>
      </ul>
      
      
      
      <ul class="p-facts">
        <li>
          <header><a href="https://onthedock.github.io/tags/">tags</a></header>
          <ul>
            
            <li><a href="https://onthedock.github.io/tags/linux/">linux</a></li>
            
            <li><a href="https://onthedock.github.io/tags/debian/">debian</a></li>
            
            <li><a href="https://onthedock.github.io/tags/ansible/">ansible</a></li>
            
          </ul>
        </li>
      </ul>
      
      
    </section>
  </footer>
</article>

<article>
  <div id="disqus_thread"></div>
  <script>
  
  

  

  (function() { 
  var d = document, s = d.createElement('script');
  s.src = 'https://onthedock.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                              

</article>



  
  
  <section>
    <header><span>Latests</span></header>
    <ul class="p-articles thin">
      <li><article class="li sm article-1be861ee6a7c05ba2a5776a68120327c">
  <div class="header-wrapper">
    <a href="https://onthedock.github.io/post/201208-actualizar-el-certificado-de-traefik-en-k3s/" class="thumbnail" title="Actualizar el certificado de Traefik en K3s"></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="https://onthedock.github.io/post/201208-actualizar-el-certificado-de-traefik-en-k3s/">Actualizar el certificado de Traefik en K3s</a></h2>
        <ul class="p-facts">
          <li><time datetime="2020-12-08T09:09:23JST">8 Dec 2020</time></li>
          <li><a href="https://onthedock.github.io/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li><li><article class="li sm article-6196d298c4378d228f2ab7aeacc3b954">
  <div class="header-wrapper">
    <a href="https://onthedock.github.io/post/201208-problemas-relacionados-con-gitops/" class="thumbnail" title="Interesante artículo &#34;More Problems with GitOps — and How to Fix Them&#34; en TheNewStack"></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="https://onthedock.github.io/post/201208-problemas-relacionados-con-gitops/">Interesante artículo &#34;More Problems with GitOps — and How to Fix Them&#34; en TheNewStack</a></h2>
        <ul class="p-facts">
          <li><time datetime="2020-12-08T07:54:26JST">8 Dec 2020</time></li>
          <li><a href="https://onthedock.github.io/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li><li><article class="li sm article-989c3a6a94e729ffbdf9bda5f321b198">
  <div class="header-wrapper">
    <a href="https://onthedock.github.io/post/201206-side-project/" class="thumbnail" title="Side Project: devtoolbox"></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="https://onthedock.github.io/post/201206-side-project/">Side Project: devtoolbox</a></h2>
        <ul class="p-facts">
          <li><time datetime="2020-12-06T22:02:24JST">6 Dec 2020</time></li>
          <li><a href="https://onthedock.github.io/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li><li><article class="li sm article-b5774c1af73ca2d2b4752dba3cca3af5">
  <div class="header-wrapper">
    <a href="https://onthedock.github.io/post/201013-instalar-mkdocs-en-alpine/" class="thumbnail" title="[Solucionado] Instalación de MkDocs en Alpine y en MacOS (Catalina)"></a>
    <header class="article-header">
      <div class="clearfix">
        <h2 class="title"><a href="https://onthedock.github.io/post/201013-instalar-mkdocs-en-alpine/">[Solucionado] Instalación de MkDocs en Alpine y en MacOS (Catalina)</a></h2>
        <ul class="p-facts">
          <li><time datetime="2020-10-13T18:43:49JST">13 Oct 2020</time></li>
          <li><a href="https://onthedock.github.io/post/">post</a></li>
          
        </ul>
      </div>
    </header>
  </div>
</article>
</li>
    </ul>
  </section>
  
</div>


    </main>

    

    <footer class="l-footer">
      <div class="l-container">
        <p class="copyright-notice">Handmade with &#9829; by Xavi Aznar</p>
        <aside>
          <p class="attribution">Powered by <a href="https://gohugo.io/">Hugo</a> using <a href="https://github.com/dim0627/hugo_theme_aglaus" class="h-logo">Aglaus</a> (designed by <a href="http://yet.unresolved.xyz/">Daisuke Tsuji</a>).</p>
        </aside>
      </div>
    </footer>

    <a href="#" class="p-movetop" title="ページ上部へ戻る" rel="nofollow"></a>
  </body>
</html>

